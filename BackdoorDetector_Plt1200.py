{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"mount_file_id":"1hbqWnXfnnTpnxOd5GunGnGfqOriFV3PH","authorship_tag":"ABX9TyMtdbr7ojCbjkO0OO/VA2Dh"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"a978516fb90545d1a0964dcbc261f3be":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6d2dfcc04e7442e0a9a17aa6f07edafe","IPY_MODEL_591b64f9f9d240e4a3ccd604599757ab","IPY_MODEL_c03f212de762474bbb29842c68ea98e4"],"layout":"IPY_MODEL_7330cb52c3e548f688908fc533059483"}},"6d2dfcc04e7442e0a9a17aa6f07edafe":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a97be3624bb14db6a0c96cc74fc2ef8a","placeholder":"​","style":"IPY_MODEL_897ef0af94af4ee18c4dbe119eb7a845","value":"100%"}},"591b64f9f9d240e4a3ccd604599757ab":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9ed55e41cb594337a22540261fd33a85","max":2313,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fb4f4d26dd7d4f39a3ddc336a7c3d322","value":2313}},"c03f212de762474bbb29842c68ea98e4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_82646d67a8f54c7bbb17f058d15830c9","placeholder":"​","style":"IPY_MODEL_439b739e14564999991dae09c8b60135","value":" 2313/2313 [00:00&lt;00:00, 2946.06it/s]"}},"7330cb52c3e548f688908fc533059483":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a97be3624bb14db6a0c96cc74fc2ef8a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"897ef0af94af4ee18c4dbe119eb7a845":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9ed55e41cb594337a22540261fd33a85":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fb4f4d26dd7d4f39a3ddc336a7c3d322":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"82646d67a8f54c7bbb17f058d15830c9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"439b739e14564999991dae09c8b60135":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"775e8fc0666c47acb9aad7bff83564cd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a296d51890194786ba4e600572f02437","IPY_MODEL_2c5d5951b39f4168b8d1f2f548eaf913","IPY_MODEL_5ccb8acd7e6f4f86a2824171c38b1000"],"layout":"IPY_MODEL_ed8ded31e6d9489580f343608a30f2b5"}},"a296d51890194786ba4e600572f02437":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_148bfefd4db1469fa3b90fc181cd5f5b","placeholder":"​","style":"IPY_MODEL_8b5834e0eac044da8b13312f2b4d6fb8","value":""}},"2c5d5951b39f4168b8d1f2f548eaf913":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_fdca5f99b02340c1bca068f39854ca97","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2d6df1412d6b464ab77402c39172aa4f","value":1}},"5ccb8acd7e6f4f86a2824171c38b1000":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_248107444f56480695ad7da090558d99","placeholder":"​","style":"IPY_MODEL_2f935f530f8845b08b8fc1e3c2ab9c98","value":" 2313/? [00:27&lt;00:00, 73.16it/s]"}},"ed8ded31e6d9489580f343608a30f2b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"148bfefd4db1469fa3b90fc181cd5f5b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8b5834e0eac044da8b13312f2b4d6fb8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fdca5f99b02340c1bca068f39854ca97":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"2d6df1412d6b464ab77402c39172aa4f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"248107444f56480695ad7da090558d99":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2f935f530f8845b08b8fc1e3c2ab9c98":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["a978516fb90545d1a0964dcbc261f3be","6d2dfcc04e7442e0a9a17aa6f07edafe","591b64f9f9d240e4a3ccd604599757ab","c03f212de762474bbb29842c68ea98e4","7330cb52c3e548f688908fc533059483","a97be3624bb14db6a0c96cc74fc2ef8a","897ef0af94af4ee18c4dbe119eb7a845","9ed55e41cb594337a22540261fd33a85","fb4f4d26dd7d4f39a3ddc336a7c3d322","82646d67a8f54c7bbb17f058d15830c9","439b739e14564999991dae09c8b60135","775e8fc0666c47acb9aad7bff83564cd","a296d51890194786ba4e600572f02437","2c5d5951b39f4168b8d1f2f548eaf913","5ccb8acd7e6f4f86a2824171c38b1000","ed8ded31e6d9489580f343608a30f2b5","148bfefd4db1469fa3b90fc181cd5f5b","8b5834e0eac044da8b13312f2b4d6fb8","fdca5f99b02340c1bca068f39854ca97","2d6df1412d6b464ab77402c39172aa4f","248107444f56480695ad7da090558d99","2f935f530f8845b08b8fc1e3c2ab9c98"]},"id":"Xch7mhwHrhWm","executionInfo":{"status":"ok","timestamp":1675670670902,"user_tz":-540,"elapsed":940758,"user":{"displayName":"清水嶺","userId":"11678528705416048401"}},"outputId":"483780b5-7d4f-42db-f7aa-daee7ed7d2c4"},"outputs":[{"output_type":"stream","name":"stdout","text":["(2313, 1200)\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/2313 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a978516fb90545d1a0964dcbc261f3be"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["creating word2vec model ...\n"]},{"output_type":"stream","name":"stderr","text":["WARNING:gensim.models.base_any2vec:Effective 'alpha' higher than previous training cycles\n"]},{"output_type":"stream","name":"stdout","text":["Done.\n","2313\n"]},{"output_type":"display_data","data":{"text/plain":["0it [00:00, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"775e8fc0666c47acb9aad7bff83564cd"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["            X1        X2        X3        X4        X5        X6        X7  \\\n","0     0.314017  0.008655  0.532289 -0.310312  0.225067 -0.120089 -0.249834   \n","1     0.432685 -0.060610  0.672785 -0.185386  0.166694 -0.114977 -0.187397   \n","2     0.427991 -0.087038  0.646085 -0.156360  0.167629 -0.121857 -0.187324   \n","3     0.426776 -0.084096  0.645111 -0.155968  0.163596 -0.118288 -0.184241   \n","4     0.372158 -0.070454  0.578464 -0.091248  0.091741 -0.098442 -0.140276   \n","...        ...       ...       ...       ...       ...       ...       ...   \n","2308  0.358793  0.024470  0.627681 -0.211617  0.307867 -0.194477 -0.308245   \n","2309  0.299288  0.014996  0.502934 -0.258057  0.225262 -0.114679 -0.259902   \n","2310  0.404164 -0.093118  0.591419 -0.125320  0.135587 -0.087255 -0.177962   \n","2311  0.358051  0.020084  0.611354 -0.239298  0.327781 -0.174019 -0.308433   \n","2312  0.215501 -0.022102  0.470386  0.045410  0.126624 -0.088547 -0.162327   \n","\n","            X8        X9       X10  ...  tfidf_X1190  tfidf_X1191  \\\n","0     0.119289 -0.135101 -0.319439  ...          0.0     0.092065   \n","1     0.127452  0.052212 -0.172046  ...          0.0     0.103487   \n","2     0.130249 -0.115592 -0.170665  ...          0.0     0.127694   \n","3     0.131352 -0.114376 -0.169261  ...          0.0     0.124828   \n","4     0.123936 -0.158150 -0.209789  ...          0.0     0.107098   \n","...        ...       ...       ...  ...          ...          ...   \n","2308  0.059337 -0.152829 -0.355083  ...          0.0     0.106901   \n","2309  0.083682 -0.118103 -0.333042  ...          0.0     0.099878   \n","2310  0.117938 -0.212537 -0.203801  ...          0.0     0.129498   \n","2311  0.050187 -0.152878 -0.325818  ...          0.0     0.098976   \n","2312 -0.014913 -0.219505 -0.321037  ...          0.0     0.001291   \n","\n","      tfidf_X1192  tfidf_X1193  tfidf_X1194  tfidf_X1195  tfidf_X1196  \\\n","0        0.035742     0.018607     0.018043     0.011084     0.009053   \n","1        0.030197     0.008650     0.000000     0.000000     0.000000   \n","2        0.060042     0.005123     0.000000     0.002377     0.000000   \n","3        0.060510     0.005163     0.000000     0.002395     0.000000   \n","4        0.043986     0.002262     0.000000     0.000000     0.000000   \n","...           ...          ...          ...          ...          ...   \n","2308     0.027613     0.014941     0.017660     0.008155     0.008660   \n","2309     0.048447     0.030358     0.053605     0.018779     0.016617   \n","2310     0.025794     0.006465     0.001074     0.000000     0.000000   \n","2311     0.036007     0.024067     0.030224     0.005583     0.000000   \n","2312     0.000000     0.000000     0.000000     0.000000     0.000000   \n","\n","      tfidf_X1197  tfidf_X1198  tfidf_X1199  \n","0        0.003506     0.007104     0.004952  \n","1        0.000000     0.000000     0.005827  \n","2        0.000000     0.000000     0.000000  \n","3        0.000000     0.000000     0.000000  \n","4        0.000000     0.000000     0.000000  \n","...           ...          ...          ...  \n","2308     0.009390     0.001699     0.011842  \n","2309     0.012356     0.007824     0.000000  \n","2310     0.000000     0.000000     0.000000  \n","2311     0.000000     0.000000     0.000000  \n","2312     0.000000     0.000000     0.020941  \n","\n","[2313 rows x 2400 columns]\n","      label_id\n","0            0\n","1            0\n","2            0\n","3            0\n","4            0\n","...        ...\n","2308         1\n","2309         1\n","2310         1\n","2311         1\n","2312         1\n","\n","[2313 rows x 1 columns]\n","Training XGboost model ...\n","[0]\ttrain-logloss:0.449175\teval-logloss:0.462881\n","Multiple eval metrics have been passed: 'eval-logloss' will be used for early stopping.\n","\n","Will train until eval-logloss hasn't improved in 10 rounds.\n","[1]\ttrain-logloss:0.312625\teval-logloss:0.334015\n","[2]\ttrain-logloss:0.224391\teval-logloss:0.252163\n","[3]\ttrain-logloss:0.165189\teval-logloss:0.19823\n","[4]\ttrain-logloss:0.123296\teval-logloss:0.161051\n","[5]\ttrain-logloss:0.093209\teval-logloss:0.135509\n","[6]\ttrain-logloss:0.071272\teval-logloss:0.116008\n","[7]\ttrain-logloss:0.055082\teval-logloss:0.102868\n","[8]\ttrain-logloss:0.043212\teval-logloss:0.092908\n","[9]\ttrain-logloss:0.034401\teval-logloss:0.085223\n","[10]\ttrain-logloss:0.027488\teval-logloss:0.078609\n","[11]\ttrain-logloss:0.022465\teval-logloss:0.075585\n","[12]\ttrain-logloss:0.018741\teval-logloss:0.073333\n","[13]\ttrain-logloss:0.015913\teval-logloss:0.071755\n","[14]\ttrain-logloss:0.013497\teval-logloss:0.067927\n","[15]\ttrain-logloss:0.011616\teval-logloss:0.066967\n","[16]\ttrain-logloss:0.010235\teval-logloss:0.066979\n","[17]\ttrain-logloss:0.009133\teval-logloss:0.067086\n","[18]\ttrain-logloss:0.008256\teval-logloss:0.066061\n","[19]\ttrain-logloss:0.00755\teval-logloss:0.064639\n","[20]\ttrain-logloss:0.007011\teval-logloss:0.065289\n","[21]\ttrain-logloss:0.006499\teval-logloss:0.063818\n","[22]\ttrain-logloss:0.006067\teval-logloss:0.06481\n","[23]\ttrain-logloss:0.005715\teval-logloss:0.064417\n","[24]\ttrain-logloss:0.005404\teval-logloss:0.065147\n","[25]\ttrain-logloss:0.005078\teval-logloss:0.06467\n","[26]\ttrain-logloss:0.004866\teval-logloss:0.065307\n","[27]\ttrain-logloss:0.004634\teval-logloss:0.065569\n","[28]\ttrain-logloss:0.004467\teval-logloss:0.065552\n","[29]\ttrain-logloss:0.004281\teval-logloss:0.065552\n","[30]\ttrain-logloss:0.00413\teval-logloss:0.066167\n","[31]\ttrain-logloss:0.004003\teval-logloss:0.066109\n","Stopping. Best iteration:\n","[21]\ttrain-logloss:0.006499\teval-logloss:0.063818\n","\n","Done.\n","Accuracy: 0.9755043227665706\n","              precision    recall  f1-score   support\n","\n","           0       0.88      0.79      0.83        53\n","           1       0.98      0.99      0.99       641\n","\n","    accuracy                           0.98       694\n","   macro avg       0.93      0.89      0.91       694\n","weighted avg       0.97      0.98      0.97       694\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAYIAAAEGCAYAAABo25JHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3deXxU9b34/9d7luwhCSQEWUJYw04grIbVrWiriBtoFanbtbf+9NZbK9/2XrW2vdqr11qrxX1f0IpaFCoqEBHLZthkJ+wB2UnIQpaZfH5/nJMQIAmTZTKTzPv5eJzH2c95fzIw7znnc87nI8YYlFJKhS5HoANQSikVWJoIlFIqxGkiUEqpEKeJQCmlQpwmAqWUCnGuQAdQX4mJiSY1NbVB+xYVFREdHd20AQWIliX4tJZygJYlWDWmLNnZ2UeNMUk1rWtxiSA1NZXvvvuuQftmZWUxYcKEpg0oQLQswae1lAO0LMGqMWURkT21rdNbQ0opFeI0ESilVIjTRKCUUiGuxdURKKWCW3l5Obm5uZSUlAQ6FADi4uLYvHlzoMNoEr6UJSIigs6dO+N2u30+riYCpVSTys3NJTY2ltTUVEQk0OFQUFBAbGxsoMNoEucrizGGY8eOkZubS7du3Xw+rt4aUko1qZKSEtq1axcUSSDUiAjt2rWr99WYJgKlVJPTJBA4Dfnbh04i2LucbjvfBG12WymlzhA6ieCHdXTdOwcKDgY6EqWUH+Xl5fG3v/2tQfteccUV5OXl+bz9I488wpNPPtmgc2VlZfGTn/ykQfs2tdBJBMkDrPGhjYGNQynlV3UlAo/HU+e+8+fPJz4+3h9hBbUQSgT9rfGh7wMbh1LKr2bOnMmOHTtIT0/ngQce4JtvvmHs2LFcddVV9OvXD4Crr76ajIwM+vfvz4svvli1b2pqKkePHmX37t307duXO++8k/79+3PZZZdx6tSpOs+7du1aRo0axaBBg5gyZQonTpwAYNWqVQwaNKgqngEDBpyz7/Hjx7n66qsZNGgQo0aNYv369QB8/fXXpKenk56ezpAhQygoKOCHH35g3LhxpKenM2DAAL755ptG/81C5/HRyHhKwtsTcXBDoCNRKmT87tONbDpwskmP2a9jGx6+sn+t6x9//HE2bNjA2rVrAetX/urVq9mwYUPVI5Wvvvoqbdu25dSpUwwfPpxrr72Wdu3anXGc7du389577/HSSy9xww03MGfOHG6++eZazzt9+nT++te/Mn78eB566CF+97vf8fTTT/Ozn/2Ml156idGjRzNz5swa93344YcZMmQIn3zyCYsWLWL69OmsXbuWJ598kueee47MzEwKCwspLy/n1Vdf5Uc/+hG//e1v8Xq9FBcX1/dPeI7QuSIACmO6wiFNBEqFmhEjRpzxXP0zzzzD4MGDGTVqFPv27WP79u3n7NOtWzfS09MByMjIYPfu3bUePz8/n7y8PMaPHw/ArbfeypIlS8jLy6OgoIDRo0cDcNNNN9W4/9KlS7nlllsAuOiiizh27BgnT54kMzOT+++/n2eeeYa8vDxcLhfDhw/ntdde45FHHuH7779vknckQuaK4OttRzhe1IWrS/+BlJeAOyLQISnV6tX1y705VW+6OSsri6+++oply5YRFRXFhAkTanzuPjw8vGra6XSe99aQP8ycOZMf//jHzJ8/n8zMTD766CPGjRvHkiVLmDdvHjNmzOD+++9n+vTpjTpPyFwR7D1ezBcnuyDGC0e2BDocpZSfxMbGUlBQUOv6/Px8EhISiIqKYsuWLSxfvrzR54yLiyMhIaHqfv1bb73F+PHjiY+PJzY2lhUrVgAwe/bsGvcfO3Ys77zzDmAlqsTERNq0acOOHTsYOHAgDz74IMOHD2fbtm3s2bOH5ORk7rzzTu644w5Wr17d6PhD5oogLTmWV0yKNXNoA3RMD2xASim/aNeuHZmZmQwYMIDLL7+ciRMnnrF+0qRJPP/88/Tt25e0tDRGjRrVJOd94403uPvuuykuLqZ79+689tprALzyyivceeedOBwOxo8fT1xc3Dn7PvLII9x2220MGjSIqKgo3njjDQCefvppFi9ejMPhoH///lx66aXMmzePJ554ArfbTUxMDG+++WbjgzfGtKghIyPDNMSJolLT7cG5pux37Y2Z/2CDjhFMFi9eHOgQmkxrKUtrKYcxjSvLpk2bmi6QJnDy5MmAnr+goKBq+rHHHjP33ntvg4/la1lq+gyA70wt36shc0UQHxVGm3AnB8K601UrjJVSzWTevHk89thjeDweunbtyuuvvx7okM4RMokAoHOMg02eFLoeWmE1NaHtoSil/Gzq1KlMnTo10GHUKWQqiwE6xworijvCqRNw8kCgw1FK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\n"},"metadata":{"needs_background":"light"}}],"source":["import pandas as pd\n","import numpy as np\n","import xgboost as xgb\n","import logging\n","from tqdm.notebook import tqdm\n","from gensim.models import Word2Vec\n","from scipy import spatial\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.model_selection import train_test_split\n","from sklearn.model_selection import StratifiedKFold\n","from sklearn.model_selection import cross_validate\n","from sklearn.metrics import classification_report\n","from sklearn.metrics import accuracy_score\n","from matplotlib import pyplot as plt\n","datasets = pd.read_csv(\"./drive/MyDrive/evmbytecodes.csv\", names=(\"label\", \"evmcode\")) #データセット読み込み\n","\n","# word2vec parameters\n","num_features    = 1200\n","min_word_count  = 5\n","num_workers     = 40\n","context         = 10\n","downsampling    = 1e-3\n","model_name = \"evmcode_feature200.model\"\n","\n","# コーパス読み込み\n","corpus = []\n","tfidf_X = []\n","\n","# TF_IDFによる文書ベクトルの生成\n","vectorizer = TfidfVectorizer(max_features= num_features )\n","tfidf_X = vectorizer.fit_transform(datasets[\"evmcode\"])\n","print(tfidf_X.shape)\n","tfidf_data_X = pd.DataFrame(tfidf_X.toarray(),columns=[\"tfidf_X\"+str(i) for i in range(tfidf_X.shape[1])])\n","for doc in tqdm(datasets[\"evmcode\"]):\n","    corpus.append(doc.split(\" \"))\n","\n","# word2vecモデルの作成＆モデルの保存\n","print(\"creating word2vec model ...\")\n","logging.basicConfig(format='%(asctime)s : %(levelname)s : %(message)s', level=logging.INFO)\n","model = Word2Vec(corpus,size= num_features ,alpha=0.025,window=5,min_count=5,workers=4,min_alpha=0.001)\n","model.train(corpus,total_examples=len(corpus),epochs=50)\n","model.save(model_name)\n","print(\"Done.\")\n","\n","# word2vecによる文書ベクトルの生成\n","def wordvec2docvec(sentence,model):\n","    # 文章ベクトルの初期値（0ベクトルを初期値とする）\n","    docvecs = np.zeros(num_features, dtype=\"float32\")\n","    # 文章に現れる単語のうち、モデルに存在しない単語をカウントする\n","    denomenator = len(sentence)\n","    # 文章内の各単語ベクトルを足し合わせる\n","    for word in sentence:\n","        try:\n","            temp = model.wv[word]\n","        except:\n","            denomenator -= 1\n","            continue\n","        docvecs += temp\n","    # 文章に現れる単語のうち、モデルに存在した単語の数で割る\n","    if denomenator > 0:\n","        docvecs =  docvecs / denomenator\n","    return docvecs\n","\n","print(len(datasets[\"evmcode\"]))\n","X, Y = [], []\n","for lb, code in tqdm(zip(datasets[\"label\"], datasets[\"evmcode\"])):\n","    docvec = wordvec2docvec(code.split(\" \"),model)\n","    X.append(list(docvec))\n","    Y.append(lb)\n","\n","# データフレームの構築\n","data_X = pd.DataFrame(X, columns=[\"X\" + str(i + 1) for i in range(num_features)])\n","data_Y = pd.DataFrame(Y, columns=[\"label_id\"])\n","data_TFIDF_W2V = pd.concat([data_X,tfidf_data_X],axis=1)\n","print(data_TFIDF_W2V)\n","print(data_Y)\n","\n","# テストデータの分割\n","train_x, test_x, train_y, test_y = train_test_split(data_TFIDF_W2V, data_Y, train_size= 0.7)\n","\n","# XGBoost が扱うデータセットの形式に直す\n","dtrain = xgb.DMatrix(train_x, label=train_y)\n","dtest = xgb.DMatrix(test_x, label=test_y)\n","\n","# 学習用のパラメータ\n","xgb_params = {\n","    # 二値分類問題\n","    'objective': 'binary:logistic',\n","    # 評価指標\n","    'eval_metric': 'logloss',\n","    }\n","\n","# 学習時に用いる検証用データ\n","evals = [(dtrain, 'train'), (dtest, 'eval')]\n","# 学習過程を記録するための辞書\n","evals_result = {}\n","\n","# XGboostモデルの学習\n","print(\"Training XGboost model ...\")\n","#xgb_model = xgb.XGBClassifier()\n","#xgb_model.fit(train_x, train_y)\n","xgb_model = xgb.train(xgb_params,\n","                dtrain,\n","                num_boost_round = 1000, #多めに設定しておく\n","                early_stopping_rounds=10, #10ラウンド学習しても改善が見込めない場合は学習を打ち切る\n","                evals=evals,\n","                evals_result=evals_result)\n","print(\"Done.\")\n","\n","# 検証\n","pred_proba = xgb_model.predict(dtest)\n","pred = np.where(pred_proba > 0.5, 1, 0)\n","acc = accuracy_score(test_y, pred)\n","print('Accuracy:', acc)\n","#for p, i, l in zip(pred, test_y.index, test_y[\"label_id\"]) :\n","#  if p > 0.5 :\n","#    if l!=1:\n","#      ##予測ラベルが1でないなら対応するバイトコードを出力\n","#      datasets.loc[i].to_csv('./drive/MyDrive/ErrorList06.csv', mode='a')\n","#  else :\n","#    if l!=0:\n","#      ##予測ラベルが0でないなら対応するバイトコードを出力\n","#      datasets.loc[i].to_csv('./drive/MyDrive/ErrorList06.csv', mode='a')\n","\n","print(classification_report(pred, test_y[\"label_id\"]))\n","\n","# 学習の過程を折れ線グラフとして出力\n","train_metric = evals_result['train']['logloss']\n","plt.plot(train_metric, label='train logloss')\n","eval_metric = evals_result['eval']['logloss']\n","plt.plot(eval_metric, label='eval logloss')\n","plt.grid()\n","plt.legend()\n","plt.xlabel('rounds')\n","plt.ylabel('logloss')\n","plt.show()"]}]}