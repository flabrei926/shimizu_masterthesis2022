{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"mount_file_id":"16Md8pR9oK658Fe8ls5gysTSpeWd8L2Yt","authorship_tag":"ABX9TyMUJSrpR/9y8sqzE5oeRhpS"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"b6e93f9ca6c445c1bfae8bc18186cd3c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d68e19aad3444ac08899d637aea93178","IPY_MODEL_3cfc81a6fa7546bda7a74daea6dec7dd","IPY_MODEL_f784142451d64aa68d58cdab285aeed0"],"layout":"IPY_MODEL_f9c4ff3f897e4305a547199adabb0af1"}},"d68e19aad3444ac08899d637aea93178":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_26fb1a6172084779b92eb149886d4b01","placeholder":"​","style":"IPY_MODEL_3e6fc7807fdd4536a0eee6f491dac32b","value":"100%"}},"3cfc81a6fa7546bda7a74daea6dec7dd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0207ae86fe1c4079a660643f501d9432","max":2313,"min":0,"orientation":"horizontal","style":"IPY_MODEL_c5b5c6f58cd04651b482c2fb2ba20fa4","value":2313}},"f784142451d64aa68d58cdab285aeed0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_15ce6b28273f4210a1665ee543c335e4","placeholder":"​","style":"IPY_MODEL_dc082a581408482f96ea068b40dc0812","value":" 2313/2313 [00:01&lt;00:00, 2026.33it/s]"}},"f9c4ff3f897e4305a547199adabb0af1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"26fb1a6172084779b92eb149886d4b01":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3e6fc7807fdd4536a0eee6f491dac32b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0207ae86fe1c4079a660643f501d9432":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c5b5c6f58cd04651b482c2fb2ba20fa4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"15ce6b28273f4210a1665ee543c335e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dc082a581408482f96ea068b40dc0812":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e8b5567b9fc8492b8dd9be530890c749":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6e1848e8d76840189baa74ab5e5b9ebf","IPY_MODEL_b811730544af4212a3d0ddda6eb2f691","IPY_MODEL_ad3db70f99574201bca7423119b729fc"],"layout":"IPY_MODEL_0cd8a43067aa4d0ba427537c7c92aa1d"}},"6e1848e8d76840189baa74ab5e5b9ebf":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6bb21ff87e3c46c9ab6cb16ec7b50f2f","placeholder":"​","style":"IPY_MODEL_40f272d73142456181a87813b0afcf6a","value":""}},"b811730544af4212a3d0ddda6eb2f691":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_01603c2f64334504802fc4ec4096a6de","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_792ba4e584a74f1cbed99e3e13d3435e","value":1}},"ad3db70f99574201bca7423119b729fc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_be565fc9c6ad441aa5576a0bb976a885","placeholder":"​","style":"IPY_MODEL_602befb3dce946fcbd204f5dbeea2022","value":" 2313/? [00:29&lt;00:00, 65.80it/s]"}},"0cd8a43067aa4d0ba427537c7c92aa1d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6bb21ff87e3c46c9ab6cb16ec7b50f2f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"40f272d73142456181a87813b0afcf6a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"01603c2f64334504802fc4ec4096a6de":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"792ba4e584a74f1cbed99e3e13d3435e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"be565fc9c6ad441aa5576a0bb976a885":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"602befb3dce946fcbd204f5dbeea2022":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["b6e93f9ca6c445c1bfae8bc18186cd3c","d68e19aad3444ac08899d637aea93178","3cfc81a6fa7546bda7a74daea6dec7dd","f784142451d64aa68d58cdab285aeed0","f9c4ff3f897e4305a547199adabb0af1","26fb1a6172084779b92eb149886d4b01","3e6fc7807fdd4536a0eee6f491dac32b","0207ae86fe1c4079a660643f501d9432","c5b5c6f58cd04651b482c2fb2ba20fa4","15ce6b28273f4210a1665ee543c335e4","dc082a581408482f96ea068b40dc0812","e8b5567b9fc8492b8dd9be530890c749","6e1848e8d76840189baa74ab5e5b9ebf","b811730544af4212a3d0ddda6eb2f691","ad3db70f99574201bca7423119b729fc","0cd8a43067aa4d0ba427537c7c92aa1d","6bb21ff87e3c46c9ab6cb16ec7b50f2f","40f272d73142456181a87813b0afcf6a","01603c2f64334504802fc4ec4096a6de","792ba4e584a74f1cbed99e3e13d3435e","be565fc9c6ad441aa5576a0bb976a885","602befb3dce946fcbd204f5dbeea2022"]},"id":"g5nFYNNcSyTv","executionInfo":{"status":"ok","timestamp":1675666087603,"user_tz":-540,"elapsed":390646,"user":{"displayName":"清水嶺","userId":"11678528705416048401"}},"outputId":"8fdffbc1-065b-4875-9b51-810e9f6cae44"},"outputs":[{"output_type":"stream","name":"stdout","text":["(2313, 200)\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/2313 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b6e93f9ca6c445c1bfae8bc18186cd3c"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["creating word2vec model ...\n"]},{"output_type":"stream","name":"stderr","text":["WARNING:gensim.models.base_any2vec:Effective 'alpha' higher than previous training cycles\n"]},{"output_type":"stream","name":"stdout","text":["Done.\n","2313\n"]},{"output_type":"display_data","data":{"text/plain":["0it [00:00, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e8b5567b9fc8492b8dd9be530890c749"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["            X1        X2        X3        X4        X5        X6        X7  \\\n","0     0.411304 -0.549105  1.084601 -0.671163 -0.375240 -0.224387  0.659725   \n","1     0.429387 -0.697255  1.428454 -0.877436 -0.216448 -0.360110  0.559926   \n","2     0.442736 -0.627601  1.381436 -0.760456 -0.182875 -0.395450  0.588158   \n","3     0.443160 -0.628834  1.373120 -0.761641 -0.182742 -0.396054  0.590658   \n","4     0.436625 -0.569000  1.254876 -0.683901 -0.146716 -0.351524  0.515840   \n","...        ...       ...       ...       ...       ...       ...       ...   \n","2308  0.271331 -0.633404  1.193738 -0.773670 -0.458024 -0.379866  0.620879   \n","2309  0.328338 -0.562121  1.090621 -0.650344 -0.357296 -0.225351  0.581772   \n","2310  0.482981 -0.580103  1.283971 -0.650371 -0.136984 -0.377945  0.605885   \n","2311  0.281479 -0.651648  1.169575 -0.797132 -0.475734 -0.369069  0.661842   \n","2312  0.302891 -0.394469  0.894947 -0.602251 -0.280286 -0.398769  0.723096   \n","\n","            X8        X9       X10  ...  tfidf_X190  tfidf_X191  tfidf_X192  \\\n","0    -0.695553  0.170330 -0.436112  ...    0.022680    0.000251    0.106529   \n","1    -0.785401  0.023960 -0.096214  ...    0.019409    0.009434    0.058226   \n","2    -0.833641  0.133178 -0.175664  ...    0.019156    0.009777    0.081733   \n","3    -0.839756  0.130853 -0.177568  ...    0.019304    0.009853    0.081076   \n","4    -0.812727  0.151575 -0.215537  ...    0.023673    0.014795    0.068764   \n","...        ...       ...       ...  ...         ...         ...         ...   \n","2308 -0.702414  0.137522 -0.326633  ...    0.012268    0.001438    0.105593   \n","2309 -0.605886  0.180430 -0.314169  ...    0.021191    0.002207    0.092838   \n","2310 -0.820439  0.206930 -0.307106  ...    0.011716    0.012814    0.063269   \n","2311 -0.667345  0.106959 -0.293375  ...    0.015039    0.004934    0.135347   \n","2312 -0.829512  0.047766 -0.358448  ...    0.024798    0.037669    0.024798   \n","\n","      tfidf_X193  tfidf_X194  tfidf_X195  tfidf_X196  tfidf_X197  tfidf_X198  \\\n","0       0.238028    0.092135    0.035770    0.018621    0.018057    0.011092   \n","1       0.284659    0.103557    0.030217    0.008656    0.000000    0.000000   \n","2       0.295005    0.127763    0.060075    0.005126    0.000000    0.002378   \n","3       0.295992    0.124886    0.060538    0.005166    0.000000    0.002397   \n","4       0.286329    0.107138    0.044002    0.002262    0.000000    0.000000   \n","...          ...         ...         ...         ...         ...         ...   \n","2308    0.238351    0.106954    0.027627    0.014949    0.017669    0.008159   \n","2309    0.294659    0.099945    0.048479    0.030378    0.053641    0.018792   \n","2310    0.297597    0.129522    0.025798    0.006466    0.001074    0.000000   \n","2311    0.251143    0.099297    0.036124    0.024145    0.030322    0.005601   \n","2312    0.121234    0.001378    0.000000    0.000000    0.000000    0.000000   \n","\n","      tfidf_X199  \n","0       0.004956  \n","1       0.005831  \n","2       0.000000  \n","3       0.000000  \n","4       0.000000  \n","...          ...  \n","2308    0.011848  \n","2309    0.000000  \n","2310    0.000000  \n","2311    0.000000  \n","2312    0.022352  \n","\n","[2313 rows x 400 columns]\n","      label_id\n","0            0\n","1            0\n","2            0\n","3            0\n","4            0\n","...        ...\n","2308         1\n","2309         1\n","2310         1\n","2311         1\n","2312         1\n","\n","[2313 rows x 1 columns]\n","Training XGboost model ...\n","[0]\ttrain-logloss:0.451615\teval-logloss:0.466825\n","Multiple eval metrics have been passed: 'eval-logloss' will be used for early stopping.\n","\n","Will train until eval-logloss hasn't improved in 10 rounds.\n","[1]\ttrain-logloss:0.315437\teval-logloss:0.342926\n","[2]\ttrain-logloss:0.228119\teval-logloss:0.260474\n","[3]\ttrain-logloss:0.169187\teval-logloss:0.202154\n","[4]\ttrain-logloss:0.127734\teval-logloss:0.16311\n","[5]\ttrain-logloss:0.096955\teval-logloss:0.131897\n","[6]\ttrain-logloss:0.074398\teval-logloss:0.110758\n","[7]\ttrain-logloss:0.058032\teval-logloss:0.094829\n","[8]\ttrain-logloss:0.04552\teval-logloss:0.084406\n","[9]\ttrain-logloss:0.036174\teval-logloss:0.075435\n","[10]\ttrain-logloss:0.029148\teval-logloss:0.06875\n","[11]\ttrain-logloss:0.023876\teval-logloss:0.064474\n","[12]\ttrain-logloss:0.019676\teval-logloss:0.060592\n","[13]\ttrain-logloss:0.016449\teval-logloss:0.056944\n","[14]\ttrain-logloss:0.013985\teval-logloss:0.053678\n","[15]\ttrain-logloss:0.012258\teval-logloss:0.051736\n","[16]\ttrain-logloss:0.010634\teval-logloss:0.050991\n","[17]\ttrain-logloss:0.009477\teval-logloss:0.049929\n","[18]\ttrain-logloss:0.008423\teval-logloss:0.049356\n","[19]\ttrain-logloss:0.007609\teval-logloss:0.046888\n","[20]\ttrain-logloss:0.006961\teval-logloss:0.045693\n","[21]\ttrain-logloss:0.00643\teval-logloss:0.044925\n","[22]\ttrain-logloss:0.006045\teval-logloss:0.045317\n","[23]\ttrain-logloss:0.005654\teval-logloss:0.044663\n","[24]\ttrain-logloss:0.005292\teval-logloss:0.044101\n","[25]\ttrain-logloss:0.004994\teval-logloss:0.044248\n","[26]\ttrain-logloss:0.004743\teval-logloss:0.044288\n","[27]\ttrain-logloss:0.004569\teval-logloss:0.044886\n","[28]\ttrain-logloss:0.004362\teval-logloss:0.045293\n","[29]\ttrain-logloss:0.004219\teval-logloss:0.045137\n","[30]\ttrain-logloss:0.004058\teval-logloss:0.044402\n","[31]\ttrain-logloss:0.003906\teval-logloss:0.044963\n","[32]\ttrain-logloss:0.003773\teval-logloss:0.044594\n","[33]\ttrain-logloss:0.00367\teval-logloss:0.044546\n","[34]\ttrain-logloss:0.003563\teval-logloss:0.044352\n","Stopping. Best iteration:\n","[24]\ttrain-logloss:0.005292\teval-logloss:0.044101\n","\n","Done.\n","Accuracy: 0.984149855907781\n","              precision    recall  f1-score   support\n","\n","           0       0.88      0.95      0.91        59\n","           1       1.00      0.99      0.99       635\n","\n","    accuracy                           0.98       694\n","   macro avg       0.94      0.97      0.95       694\n","weighted avg       0.99      0.98      0.98       694\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["import pandas as pd\n","import numpy as np\n","import xgboost as xgb\n","import logging\n","from tqdm.notebook import tqdm\n","from gensim.models import Word2Vec\n","from scipy import spatial\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.model_selection import train_test_split\n","from sklearn.model_selection import StratifiedKFold\n","from sklearn.model_selection import cross_validate\n","from sklearn.metrics import classification_report\n","from sklearn.metrics import accuracy_score\n","from matplotlib import pyplot as plt\n","datasets = pd.read_csv(\"./drive/MyDrive/evmbytecodes.csv\", names=(\"label\", \"evmcode\")) #データセット読み込み\n","\n","# word2vec parameters\n","num_features    = 200\n","min_word_count  = 5\n","num_workers     = 40\n","context         = 10\n","downsampling    = 1e-3\n","model_name = \"evmcode_feature200.model\"\n","\n","# コーパス読み込み\n","corpus = []\n","tfidf_X = []\n","\n","# TF_IDFによる文書ベクトルの生成\n","vectorizer = TfidfVectorizer(max_features=200)\n","tfidf_X = vectorizer.fit_transform(datasets[\"evmcode\"])\n","print(tfidf_X.shape)\n","tfidf_data_X = pd.DataFrame(tfidf_X.toarray(),columns=[\"tfidf_X\"+str(i) for i in range(tfidf_X.shape[1])])\n","for doc in tqdm(datasets[\"evmcode\"]):\n","    corpus.append(doc.split(\" \"))\n","\n","# word2vecモデルの作成＆モデルの保存\n","print(\"creating word2vec model ...\")\n","logging.basicConfig(format='%(asctime)s : %(levelname)s : %(message)s', level=logging.INFO)\n","model = Word2Vec(corpus,size=200,alpha=0.025,window=5,min_count=5,workers=4,min_alpha=0.001)\n","model.train(corpus,total_examples=len(corpus),epochs=50)\n","model.save(model_name)\n","print(\"Done.\")\n","\n","# word2vecによる文書ベクトルの生成\n","def wordvec2docvec(sentence,model):\n","    # 文章ベクトルの初期値（0ベクトルを初期値とする）\n","    docvecs = np.zeros(num_features, dtype=\"float32\")\n","    # 文章に現れる単語のうち、モデルに存在しない単語をカウントする\n","    denomenator = len(sentence)\n","    # 文章内の各単語ベクトルを足し合わせる\n","    for word in sentence:\n","        try:\n","            temp = model.wv[word]\n","        except:\n","            denomenator -= 1\n","            continue\n","        docvecs += temp\n","    # 文章に現れる単語のうち、モデルに存在した単語の数で割る\n","    if denomenator > 0:\n","        docvecs =  docvecs / denomenator\n","    return docvecs\n","\n","print(len(datasets[\"evmcode\"]))\n","X, Y = [], []\n","for lb, code in tqdm(zip(datasets[\"label\"], datasets[\"evmcode\"])):\n","    docvec = wordvec2docvec(code.split(\" \"),model)\n","    X.append(list(docvec))\n","    Y.append(lb)\n","\n","# データフレームの構築\n","data_X = pd.DataFrame(X, columns=[\"X\" + str(i + 1) for i in range(num_features)])\n","data_Y = pd.DataFrame(Y, columns=[\"label_id\"])\n","data_TFIDF_W2V = pd.concat([data_X,tfidf_data_X],axis=1)\n","print(data_TFIDF_W2V)\n","print(data_Y)\n","\n","# テストデータの分割\n","train_x, test_x, train_y, test_y = train_test_split(data_TFIDF_W2V, data_Y, train_size= 0.7)\n","\n","# XGBoost が扱うデータセットの形式に直す\n","dtrain = xgb.DMatrix(train_x, label=train_y)\n","dtest = xgb.DMatrix(test_x, label=test_y)\n","\n","# 学習用のパラメータ\n","xgb_params = {\n","    # 二値分類問題\n","    'objective': 'binary:logistic',\n","    # 評価指標\n","    'eval_metric': 'logloss',\n","    }\n","\n","# 学習時に用いる検証用データ\n","evals = [(dtrain, 'train'), (dtest, 'eval')]\n","# 学習過程を記録するための辞書\n","evals_result = {}\n","\n","# XGboostモデルの学習\n","print(\"Training XGboost model ...\")\n","#xgb_model = xgb.XGBClassifier()\n","#xgb_model.fit(train_x, train_y)\n","xgb_model = xgb.train(xgb_params,\n","                dtrain,\n","                num_boost_round = 1000, #多めに設定しておく\n","                early_stopping_rounds=10, #10ラウンド学習しても改善が見込めない場合は学習を打ち切る\n","                evals=evals,\n","                evals_result=evals_result)\n","print(\"Done.\")\n","\n","# 検証\n","pred_proba = xgb_model.predict(dtest)\n","pred = np.where(pred_proba > 0.5, 1, 0)\n","acc = accuracy_score(test_y, pred)\n","print('Accuracy:', acc)\n","#for p, i, l in zip(pred, test_y.index, test_y[\"label_id\"]) :\n","#  if p > 0.5 :\n","#    if l!=1:\n","#      ##予測ラベルが1でないなら対応するバイトコードを出力\n","#      datasets.loc[i].to_csv('./drive/MyDrive/ErrorList06.csv', mode='a')\n","#  else :\n","#    if l!=0:\n","#      ##予測ラベルが0でないなら対応するバイトコードを出力\n","#      datasets.loc[i].to_csv('./drive/MyDrive/ErrorList06.csv', mode='a')\n","\n","print(classification_report(pred, test_y[\"label_id\"]))\n","\n","# 学習の過程を折れ線グラフとして出力\n","train_metric = evals_result['train']['logloss']\n","plt.plot(train_metric, label='train logloss')\n","eval_metric = evals_result['eval']['logloss']\n","plt.plot(eval_metric, label='eval logloss')\n","plt.grid()\n","plt.legend()\n","plt.xlabel('rounds')\n","plt.ylabel('logloss')\n","plt.show()"]}]}