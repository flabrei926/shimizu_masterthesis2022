{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"mount_file_id":"14lbnw2cmDnn1Zv37E5emEvfhvp8o56Pw","authorship_tag":"ABX9TyOTcVuMCz2hnafftzQIEa9n"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"a9614ff1dc6849178978e24ccd389f7e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4f6f7f3a748b4344a4d67a834d4c6f67","IPY_MODEL_9793cd41ae5c484fa0d32d453dd7e8af","IPY_MODEL_791a5f09a5074124afe75af2b8441a7b"],"layout":"IPY_MODEL_a6cc8b92b3eb4540a807107dfbaa4245"}},"4f6f7f3a748b4344a4d67a834d4c6f67":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d9254284113a4b269c14a867bf07e188","placeholder":"​","style":"IPY_MODEL_cf01f67dede64911badc2dc99fa3c31b","value":"100%"}},"9793cd41ae5c484fa0d32d453dd7e8af":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_41d218fe4e5d4a20a36e39f604717716","max":2313,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cd7ad4cb91224f57bb14992720c34f5e","value":2313}},"791a5f09a5074124afe75af2b8441a7b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d2f203ca6bf24111b2fada82cd619b2a","placeholder":"​","style":"IPY_MODEL_bd9e1e7b79b947f9b14e4fde263202a0","value":" 2313/2313 [00:01&lt;00:00, 1324.34it/s]"}},"a6cc8b92b3eb4540a807107dfbaa4245":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d9254284113a4b269c14a867bf07e188":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cf01f67dede64911badc2dc99fa3c31b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"41d218fe4e5d4a20a36e39f604717716":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cd7ad4cb91224f57bb14992720c34f5e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d2f203ca6bf24111b2fada82cd619b2a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bd9e1e7b79b947f9b14e4fde263202a0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f638a9324a564790bd740958903ab6e9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_15f0e9727c5e4142b92065b264a365bb","IPY_MODEL_f7810fa09a3d4c9c842ced06f8caa9a0","IPY_MODEL_99790a0db8494445b59e21fcf0a673a0"],"layout":"IPY_MODEL_8781aee724d64c679f4d76930367fe35"}},"15f0e9727c5e4142b92065b264a365bb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_022b7e4e1f3a4071925d65176a15b572","placeholder":"​","style":"IPY_MODEL_a6340c135858479e8fdbe9afb84ee4b2","value":""}},"f7810fa09a3d4c9c842ced06f8caa9a0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ef95e71403564b97a58184ca8e6b5c40","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f27efadfee844e0b8c1792077768c658","value":1}},"99790a0db8494445b59e21fcf0a673a0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_857c85e8e4f14662bdb3b7399627b2d7","placeholder":"​","style":"IPY_MODEL_3a6b5ac46c684abf8197f82e3fcba658","value":" 2313/? [00:23&lt;00:00, 88.18it/s]"}},"8781aee724d64c679f4d76930367fe35":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"022b7e4e1f3a4071925d65176a15b572":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a6340c135858479e8fdbe9afb84ee4b2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ef95e71403564b97a58184ca8e6b5c40":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"f27efadfee844e0b8c1792077768c658":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"857c85e8e4f14662bdb3b7399627b2d7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3a6b5ac46c684abf8197f82e3fcba658":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["a9614ff1dc6849178978e24ccd389f7e","4f6f7f3a748b4344a4d67a834d4c6f67","9793cd41ae5c484fa0d32d453dd7e8af","791a5f09a5074124afe75af2b8441a7b","a6cc8b92b3eb4540a807107dfbaa4245","d9254284113a4b269c14a867bf07e188","cf01f67dede64911badc2dc99fa3c31b","41d218fe4e5d4a20a36e39f604717716","cd7ad4cb91224f57bb14992720c34f5e","d2f203ca6bf24111b2fada82cd619b2a","bd9e1e7b79b947f9b14e4fde263202a0","f638a9324a564790bd740958903ab6e9","15f0e9727c5e4142b92065b264a365bb","f7810fa09a3d4c9c842ced06f8caa9a0","99790a0db8494445b59e21fcf0a673a0","8781aee724d64c679f4d76930367fe35","022b7e4e1f3a4071925d65176a15b572","a6340c135858479e8fdbe9afb84ee4b2","ef95e71403564b97a58184ca8e6b5c40","f27efadfee844e0b8c1792077768c658","857c85e8e4f14662bdb3b7399627b2d7","3a6b5ac46c684abf8197f82e3fcba658"]},"id":"5zYcI6sBiEXZ","executionInfo":{"status":"ok","timestamp":1675667486443,"user_tz":-540,"elapsed":343645,"user":{"displayName":"清水嶺","userId":"11678528705416048401"}},"outputId":"f5b1be66-9ebe-4dd0-8421-cfba84cb8aa4"},"outputs":[{"output_type":"stream","name":"stdout","text":["(2313, 40)\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/2313 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a9614ff1dc6849178978e24ccd389f7e"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["creating word2vec model ...\n"]},{"output_type":"stream","name":"stderr","text":["WARNING:gensim.models.base_any2vec:Effective 'alpha' higher than previous training cycles\n"]},{"output_type":"stream","name":"stdout","text":["Done.\n","2313\n"]},{"output_type":"display_data","data":{"text/plain":["0it [00:00, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f638a9324a564790bd740958903ab6e9"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["            X1        X2        X3        X4        X5        X6        X7  \\\n","0    -1.458737  2.011359 -0.190468 -1.437771 -0.821071  3.312725 -1.512180   \n","1    -1.129646  2.500560 -0.112399 -1.538737 -1.046901  3.253613 -1.504690   \n","2    -0.990679  2.261423 -0.079543 -1.373670 -0.912601  3.409322 -1.328831   \n","3    -1.010195  2.254930 -0.093096 -1.380009 -0.910824  3.407527 -1.318829   \n","4    -1.152652  1.984252  0.009152 -1.221007 -1.079215  3.199551 -1.149820   \n","...        ...       ...       ...       ...       ...       ...       ...   \n","2308 -1.267326  1.780926 -0.102994 -1.590282 -0.319993  3.155476 -1.623297   \n","2309 -1.314123  1.942158 -0.066933 -1.387570 -0.772700  3.036695 -1.361748   \n","2310 -1.136175  2.039246 -0.068486 -1.267849 -1.006086  3.403267 -1.182211   \n","2311 -1.326997  1.859294 -0.152237 -1.604849 -0.327894  3.142481 -1.618972   \n","2312 -1.142548  1.040830  0.186822 -1.123644 -0.211624  2.652954 -0.663046   \n","\n","            X8        X9       X10  ...  tfidf_X30  tfidf_X31  tfidf_X32  \\\n","0     2.449132 -1.351927 -1.022030  ...   0.000491   0.031313   0.049618   \n","1     2.619905 -1.958390 -1.522182  ...   0.183233   0.028124   0.036936   \n","2     2.506772 -1.864165 -1.365482  ...   0.128753   0.032003   0.050141   \n","3     2.506458 -1.860074 -1.375127  ...   0.127011   0.032249   0.050526   \n","4     2.451849 -1.796823 -1.414579  ...   0.134205   0.036217   0.073885   \n","...        ...       ...       ...  ...        ...        ...        ...   \n","2308  2.213499 -1.092829 -0.863706  ...   0.002813   0.036748   0.068034   \n","2309  2.480294 -1.317556 -0.855155  ...   0.002168   0.045051   0.078153   \n","2310  2.633890 -1.836081 -1.341839  ...   0.115144   0.032921   0.069669   \n","2311  2.205986 -1.007694 -0.779122  ...   0.003205   0.045403   0.041039   \n","2312  1.985485 -0.974961 -1.370874  ...   0.000000   0.055477   0.125364   \n","\n","      tfidf_X33  tfidf_X34  tfidf_X35  tfidf_X36  tfidf_X37  tfidf_X38  \\\n","0      0.042910   0.000477   0.083036   0.107854   0.240991   0.093282   \n","1      0.054084   0.000000   0.056247   0.058410   0.285562   0.103886   \n","2      0.038403   0.000000   0.056325   0.081927   0.295706   0.128066   \n","3      0.038698   0.000000   0.056758   0.081267   0.296688   0.125179   \n","4      0.023767   0.000000   0.074698   0.069039   0.287473   0.107566   \n","...         ...        ...        ...        ...        ...        ...   \n","2308   0.034534   0.160105   0.039847   0.106702   0.240854   0.108077   \n","2309   0.054266   0.002104   0.070649   0.094198   0.298977   0.101409   \n","2310   0.019988   0.000000   0.044678   0.063490   0.298638   0.129975   \n","2311   0.046916   0.180353   0.040862   0.136208   0.252741   0.099929   \n","2312   0.026352   0.000000   0.059638   0.024965   0.122049   0.001388   \n","\n","      tfidf_X39  \n","0      0.036215  \n","1      0.030313  \n","2      0.060217  \n","3      0.060680  \n","4      0.044178  \n","...         ...  \n","2308   0.027917  \n","2309   0.049189  \n","2310   0.025889  \n","2311   0.036353  \n","2312   0.000000  \n","\n","[2313 rows x 80 columns]\n","      label_id\n","0            0\n","1            0\n","2            0\n","3            0\n","4            0\n","...        ...\n","2308         1\n","2309         1\n","2310         1\n","2311         1\n","2312         1\n","\n","[2313 rows x 1 columns]\n","Training XGboost model ...\n","[0]\ttrain-logloss:0.452418\teval-logloss:0.462376\n","Multiple eval metrics have been passed: 'eval-logloss' will be used for early stopping.\n","\n","Will train until eval-logloss hasn't improved in 10 rounds.\n","[1]\ttrain-logloss:0.31855\teval-logloss:0.336365\n","[2]\ttrain-logloss:0.230809\teval-logloss:0.255514\n","[3]\ttrain-logloss:0.170826\teval-logloss:0.202607\n","[4]\ttrain-logloss:0.129018\teval-logloss:0.165485\n","[5]\ttrain-logloss:0.099266\teval-logloss:0.138431\n","[6]\ttrain-logloss:0.077108\teval-logloss:0.118906\n","[7]\ttrain-logloss:0.060085\teval-logloss:0.1034\n","[8]\ttrain-logloss:0.047618\teval-logloss:0.092455\n","[9]\ttrain-logloss:0.038553\teval-logloss:0.083682\n","[10]\ttrain-logloss:0.031101\teval-logloss:0.078961\n","[11]\ttrain-logloss:0.02584\teval-logloss:0.075437\n","[12]\ttrain-logloss:0.021806\teval-logloss:0.074943\n","[13]\ttrain-logloss:0.018605\teval-logloss:0.072151\n","[14]\ttrain-logloss:0.016119\teval-logloss:0.072616\n","[15]\ttrain-logloss:0.014015\teval-logloss:0.07183\n","[16]\ttrain-logloss:0.012338\teval-logloss:0.070551\n","[17]\ttrain-logloss:0.010969\teval-logloss:0.068104\n","[18]\ttrain-logloss:0.009955\teval-logloss:0.067653\n","[19]\ttrain-logloss:0.009177\teval-logloss:0.066199\n","[20]\ttrain-logloss:0.008487\teval-logloss:0.066575\n","[21]\ttrain-logloss:0.007867\teval-logloss:0.067154\n","[22]\ttrain-logloss:0.007431\teval-logloss:0.067044\n","[23]\ttrain-logloss:0.007011\teval-logloss:0.066526\n","[24]\ttrain-logloss:0.006613\teval-logloss:0.065982\n","[25]\ttrain-logloss:0.006251\teval-logloss:0.065796\n","[26]\ttrain-logloss:0.005949\teval-logloss:0.066328\n","[27]\ttrain-logloss:0.005704\teval-logloss:0.065324\n","[28]\ttrain-logloss:0.005471\teval-logloss:0.06511\n","[29]\ttrain-logloss:0.005306\teval-logloss:0.063501\n","[30]\ttrain-logloss:0.005087\teval-logloss:0.063684\n","[31]\ttrain-logloss:0.004848\teval-logloss:0.063729\n","[32]\ttrain-logloss:0.004664\teval-logloss:0.064395\n","[33]\ttrain-logloss:0.004516\teval-logloss:0.064849\n","[34]\ttrain-logloss:0.004389\teval-logloss:0.064562\n","[35]\ttrain-logloss:0.004292\teval-logloss:0.06453\n","[36]\ttrain-logloss:0.004197\teval-logloss:0.064104\n","[37]\ttrain-logloss:0.004065\teval-logloss:0.064712\n","[38]\ttrain-logloss:0.003947\teval-logloss:0.064772\n","[39]\ttrain-logloss:0.00386\teval-logloss:0.065289\n","Stopping. Best iteration:\n","[29]\ttrain-logloss:0.005306\teval-logloss:0.063501\n","\n","Done.\n","Accuracy: 0.9798270893371758\n","              precision    recall  f1-score   support\n","\n","           0       0.89      0.86      0.88        58\n","           1       0.99      0.99      0.99       636\n","\n","    accuracy                           0.98       694\n","   macro avg       0.94      0.93      0.93       694\n","weighted avg       0.98      0.98      0.98       694\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAYIAAAEGCAYAAABo25JHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3deXxU5b348c93luwhCQmEJYGAyBJDEgiLyFLQqkCrSEFFb0Val27ceuuvXunVutVWrV5rvW51Qa0bWrfiVqpIVFQQgyCrskOQHRISss7M8/vjnJAJJBCSmcwk832/Xuc1Z59vTpL5zvM85zyPGGNQSikVuRyhDkAppVRoaSJQSqkIp4lAKaUinCYCpZSKcJoIlFIqwrlCHcCpSktLM1lZWS069siRI8THxwc2oADS+FpH42u9cI9R42u5oqKi/caYLo1uNMa0q6mgoMC01KJFi1p8bFvQ+FpH42u9cI9R42s54EvTxOeqVg0ppVSE00SglFIRThOBUkpFuHbXWKyUCm+1tbUUFxdTVVUV8HMnJSWxbt26gJ83UMIhvpiYGDIyMnC73c0+RhOBUiqgiouLSUxMJCsrCxEJ6LnLyspITEwM6DkDKdTxGWM4cOAAxcXF9OnTp9nHadWQUiqgqqqqSE1NDXgSUCcnIqSmpp5yaUwTgVIq4DQJhE5Lrn3kJIJtn9N307Og3W4rpVQDkZMIdq2k147X4cj+UEeilAqikpISHnnkkRYdO3nyZEpKSpq9/2233cZ9993XovcqLCzkhz/8YYuODbTISQSp/azXAxtDG4dSKqhOlAg8Hs8Jj3333XdJTk4ORlhhLYISQV/rVROBUh3anDlz2LRpE/n5+dxwww0UFhYyduxYLrzwQrKzswG46KKLKCgo4IwzzuDxxx8/emxWVhb79+9n69atDBo0iGuuuYYzzjiD8847j8rKyhO+74oVKzj77LPJzc1l6tSpHDp0CIBly5aRm5t7NJ6cnJzjjj148CAXXXQRubm5nHnmmXz99dcAfPTRR+Tn55Ofn8+QIUMoKytj165djBs3jvz8fHJycvjkk09afc0i5vbRg+5uJIkLpyYCpdrM7W+tYe13hwN2Pq/Xy+DMFG694Iwm97n77rtZvXo1K1asAKwqmOXLl7N69eqjt1TOnTuXzp07U1lZyfDhw5k2bRqpqakNzrNhwwZeeuklnnjiCS655BJee+01fvzjHzf5vjNnzuSee+5h0qRJ3HLLLdx+++088MAD/OQnP+GJJ55g1KhRzJkzp9Fjb731VoYMGcKbb77Jhx9+yMyZM1mxYgX33XcfDz/8MKNHj6a8vJyYmBgef/xxzj//fG666Sa8Xi8VFRWnehmPEzElgpe+/I4t3q549msiUCrSjBgxosF99Q8++CB5eXmceeaZ7Nixgw0bNhx3TJ8+fcjPzwegoKCArVu3Nnn+0tJSSkpKGDNmDABXXnklH3/8MSUlJZSVlTFq1CgALr/88kaPX7x4MVdccQUAZ599NgcOHODw4cOMHj2a66+/ngcffJCSkhJcLhfDhw/n6aef5rbbbmPVqlUBeW4hYkoEvVPj2GK6k7F3Q+T80EqF2Im+ubdESx/Y8u8aurCwkA8++IDPP/+cuLg4xo8f3+h999HR0UfnnU7nSauGgmHOnDn84Ac/4N1332X06NEsWLCAcePG8fHHH/POO+8wa9Ysrr/+embOnNmq94mYEkFWajxbTDfcpVvA5wt1OEqpIElMTKSsrKzJ7aWlpaSkpBAXF8f69etZsmRJq98zKSmJlJQUPvvsMwCee+45vve975GcnExiYiJLly4FYN68eY0eP3bsWF544QXASlRpaWl06tSJTZs2MXjwYG688UaGDx/O+vXr2bZtG+np6VxzzTVcffXVLF++vNXxR0wi6JUaxxbTDaevBg4XhzocpVSQpKamMnr0aHJycrjhhhuO2z5x4kQ8Hg+DBg1izpw5nHnmmQF532effZabb76Z3NxcVqxYwS233ALAU089xTXXXEN+fj5HjhwhKSnpuGNvu+02ioqKyM3NZc6cOTz77LMAPPDAA+Tk5JCbm4vb7WbSpEkUFhaSl5fHkCFDePnll7nuuutaH3xTAxWE69SagWlm3fxnY27tZMzGD1t8jmAK50EtjNH4Wivc4zMmMDGuXbu29YE04fDhw0E7dyA0Fl9ZWdnR+bvuusv8+te/Dnocjf0O0IFpLOWxPawZvXNIKdVG3nnnnQa3et58882hDuk4EdVu6orrTEVNDHEHNoU6FKVUhLj00ku59NJLQx3GCUVUiaBrvJMtvnS8+4+/VUwppSJVZCWCOGGL6Y5XnyVQSqmjIiwRONhsuuE6vAM8NaEORymlwkJEJYL0OAdbfd1wGC+UbAt1OEopFRYiKhEkRsEuV09rQRuMlVInUdcJXXPXN8esWbN49dVXWxtaQEVUIhARvCnaHbVSSvmLqEQAkNolnVISNREo1YE9//zzjBgxgvz8fH72s5/h9Xp57LHHGjxp/MwzzzB79myg6W6pm+P+++8nJyeHnJwcHn744aPr//CHPzBgwADGjBnDZZdd1ugANgsXLmTIkCEMHjyYn/70p1RXVwNWH0PZ2dnk5uby29/+FoB//OMf5OTkkJeXx7hx4075mpxIRD1HANA7NZ7N33Yj/8BGdFRVpYLsvTmwe1XAThfr9UDPITDp7ib3WbduHS+//DKffvopbrebX/7yl7zwwgtMmzaNUaNGce+99wLw8ssvc9NNNwHN65a6MUVFRTz99NMsXboUYwzDhw/n/PPPx+Px8Nprr7Fy5Upqa2sZOnQoBQUFDY6tqqpi1qxZLFy4kP79+zNz5kweffRRrrjiCt544w3Wr1+PiBwdMe2OO+5gwYIF9OzZ85RGUWuOiCsRZKXGsdl0w7tf2wiU6ogWLlxIUVERw4cPJz8/n4ULF7J582a6dOlC3759WbJkCQcOHGD9+vWMHj0aaF631I1ZvHgxU6dOJT4+noSEBC644AI++eQTPv30U6ZMmUJMTAyJiYlccMEFxx37zTff0KdPH/r37w/Ud12dlJRETEwMV111Fa+//jpxcXEAjB49mlmzZvHEE0/g9XoDdLUsEVci6JUax6e+7rjKP4GaIxAVf/KDlFItc4Jv7i1R2YxuqI0xXHnlldx1113HbZsxYwavvPIKAwcOZOrUqYhIs7ulbisul4svvviChQsX8uqrr/LQQw/x4Ycf8thjj7F06VLeeecdCgoKKCoqalappTkisERgdUcNwMHNoQ1GKRVw55xzDq+++ip79+4FrGEgt22zbhefOnUq//znP3nppZeYMWMG0LpuqceOHcubb75JRUUFR44c4e2332bs2LGMHj2at956i6qqKsrLy3n77bePO3bAgAFs3bqVjRut9sq6rqvLy8spLS1l8uTJ/OUvf2HlypUAbNq0iZEjR3LHHXfQpUsXduzY0arr5C/iSgTdOsWw0+HX+Vy3waENSCkVUNnZ2dx5552cd955+Hw+3G43Dz/8ML179yYlJYVBgwaxdu1aRowYAVjdUj/22GMMGjSIAQMGnFK31EOHDmXWrFlHzzVz5kyGDBkCwIUXXkhubi7p6ekMHjz4uO6nY2JiePrpp7n44ovxeDwMHz6cn//85xw8eJApU6ZQVVWFMYb7778fgBtuuIENGzZgjOGcc84hLy8vEJfL0lS3pOE6taYb6roudn9w33tWd9Qf3dvicwVDuHdTrPG1TrjHZ4x2Q91a/vHVdT995MgRU1BQYIqKitosjrDqhlpEJorINyKyUUQaH7XZ2m+aiBgRGRbMeOqkp6ayT1L1oTKlVNBce+215OfnM3ToUKZNm8bQoUNDHVKTglY1JCJO4GHgXKAYWCYi840xa4/ZLxG4DlgarFiO1Ts1nk1bupGmt5AqpYLkxRdfDHUIzRbMEsEIYKMxZrMxpgaYB0xpZL8/APcAbdZM3zs1js3edIyWCJQKCqsmQoVCS659MBuLewL+zdrFwEj/HURkKJBpjHlHRI4fXLR+v2uBawHS09MpLCxsUUDl5eUUFhZSus/DYdMdR+WHLH7/LTzuE9+O1lbq4gtXGl/rhHt8EJgYExISKC4uJikpCZHAlrm9Xu8JB6YPtVDHZ4yhtLSUI0eOnNLvMWR3DYmIA7gfmHWyfY0xjwOPAwwbNsyMHz++Re9ZWFjI+PHj6b3/CHd+9RkAYwZ1h4w2aZo4qbr4wpXG1zrhHh8EJsba2lqKi4vZuXNnYILyU1VVRUxMTMDPGyjhEF9MTAx5eXm43e5mHxPMRLATyPRbzrDX1UkEcoBC+1tDN2C+iFxojPkyiHHRMzmWbfjdQhomiUCpjsDtdtOnT5+gnLuwsPDo7ZnhKNzja0ow2wiWAaeLSB8RiQJmAPPrNhpjSo0xacaYLGNMFrAECHoSAIhyOfAmZeLDoXcOKaUiXtASgTHGA8wGFgDrgFeMMWtE5A4RuTBY79tcGWnJ7HGkay+kSqmIF9Q2AmPMu8C7x6y7pYl9xwczlmP16hzHxh3d6K6JQCkV4SKur6E6WanxbPCkYw5sBL3VTSkVwSI2EfRKjWOL6YbUVkD5nlCHo5RSIROxicDqhbS7taDVQ0qpCBaxiaBX5zi2+OzuqDURKKUiWMQmgtgoJ97EHtRKlN5CqpSKaBGbCAB6pSWyy9ldE4FSKqJFdCLo3TmOTd5uWjWklIpoEZ0IstLiWV/bFXNoC/gCOxi0Ukq1FxGdCHp1tm8h9dZAaeDG/1RKqfYkohNBVmo8W3x6C6lSKrJFdCKwHiqrSwTaYKyUikwRnQiSYt14Y1OpcsRriUApFbEiOhEA9EpL4DtnDy0RKKUiVsQngqzUODb59BZSpVTkivhE0LtzHGuru2BKd4CnOtThKKVUm9NEkBrPJl93xPjg0NZQh6OUUm1OE0FqHFuNdj6nlIpcmghS4zURKKUiWsQngrSEKDxRnSh3pWgiUEpFpIhPBCJC79R4vnP2hAObQx2OUkq1uYhPBFDXC2m6lgiUUhFJEwHQOy2O1dVdoXw3VJaEOhyllGpTmgiA3p3jWe7tay0UfxnaYJRSqo1pIsB6uniF7zSMOGHHklCHo5RSbUoTAdA7LZ5KYjiYOAC2ayJQSkUWTQRAt04xRDkdbIk9A3YWgbc21CEppVSb0UQAOB1CZudYvmIg1FbA7lWhDkkppdqMJgJb79R4Pqq0G4x3fBHaYJRSqg1pIrD1To1jeUkcJilDG4yVUhFFE4Gtb5cEKmq8VKYPh+1LwZhQh6SUUm1CE4EtLyMJgM2xOVD2HZTuCHFESinVNjQR2AZ260SU08FSTz9rxfaloQ1IKaXaiCYCW5TLQXaPTrx/IA2iErSdQCkVMTQR+MnPTGblznJ8PYfBDi0RKKUiQ1ATgYhMFJFvRGSjiMxpZPvPRWSViKwQkcUikh3MeE4mLzOJylovBzsPgT1roLoslOEopVSbCFoiEBEn8DAwCcgGLmvkg/5FY8xgY0w+8Gfg/mDF0xz5mSkArHIMBOOD4mWhDEcppdpEMEsEI4CNxpjNxpgaYB4wxX8HY8xhv8V4IKT3bGalxtEpxsVHFb1BHNpgrJSKCGKCdL+8iEwHJhpjrraXrwBGGmNmH7Pfr4DrgSjgbGPMhkbOdS1wLUB6enrBvHnzWhRTeXk5CQkJJ9znvmVVlNYY3ov6HTVRnfg6744WvVdLNCe+UNL4Wifc44Pwj1Hja7kJEyYUGWOGNbrRGBOUCZgOPOm3fAXw0An2vxx49mTnLSgoMC21aNGik+5z34L1pu/v3jE1//wvY/7YwxhPbYvf71Q1J75Q0vhaJ9zjMyb8Y9T4Wg740jTxuRrMqqGdQKbfcoa9rinzgIuCGE+z5GUk4/UZtifkQk057F0b6pCUUiqogpkIlgGni0gfEYkCZgDz/XcQkdP9Fn8AHFct1NbyMpMB+KLWDk1vI1VKdXBBSwTGGA8wG1gArANeMcasEZE7RORCe7fZIrJGRFZgtRNcGax4mqtLYjQ9k2NZvD8WErvrQDVKqQ7PFcyTG2PeBd49Zt0tfvPXBfP9Wyo/M5mVxSXQZ6SWCJRSHZ4+WdyIvMwkig9VUp4+zOp8rvRETRtKKdW+aSJoRF6G1U6wzj3IWqH9DimlOjBNBI0YnJGEQ+DTw93BHacjlimlOjRNBI2Ii3LRPz2R5d8dgZ4F2mCslOrQNBE0IT8zmZU7SjCZI63B7KvLQx2SUkoFhSaCJuRlJlNaWcve5HwwXthZFOqQlFIqKDQRNKGuwfhLbz9A9DZSpVSHpYmgCf3TE4h1O1m22wddB2k7gVKqwzrlRCAiDhHpFIxgwonL6WBwzyTrwbLMkdbYBD5fqMNSSqmAa1YiEJEXRaSTiMQDq4G1InJDcEMLvbzMJNZ8dxhPzxFQfRj2rQt1SEopFXDNLRFkG2sQmYuA94A+WN1Kd2h5mcnUeHxsijnDWqHVQ0qpDqi5icAtIm6sRDDfGFNLiEcTawt1DcZflCZBfFdtMFZKdUjNTQR/A7ZiDSf5sYj0Bg6f8IgOICMllrSEKFYWl0KvkVoiUEp1SM1KBMaYB40xPY0xk+3BbrYBE4IcW8iJCHkZyazYUQK9zoKSbXBwS6jDUkqpgGpuY/F1dmOxiMhTIrIcODvIsYWFvMxkNu0rp6zvRGvF6tdCG5BSSgVYc6uGfmo3Fp8HpGA1FN8dtKjCSF5mMsbAqrJO0GsUrPoHmA7fPKKUiiDNTQRiv04GnjPGrPFb16HlZSQBsKK4BAZPh33rYc+aEEellFKB09xEUCQi/8ZKBAtEJBGIiKerkuOi6JMWz8odJZA9FRwuq1SglFIdRHMTwVXAHGC4MaYCiAJ+ErSowkxeRpLVYByfCqedbbUT6FPGSqkOorl3DfmADOBmEbkPOMsY83VQIwsjeZnJ7Dlcze7SKsiZbg1fqc8UKKU6iObeNXQ3cB2w1p5+LSJ/CmZg4SQv03qwbMWOEhg4GVyxWj2klOowmls1NBk41xgz1xgzF5gI/DB4YYWX7O6dcDvF6oAuOhEGTII1b4C3NtShKaVUq51K76PJfvNJgQ4knMW4nQzq3slqMAYYfDFUHoTNhSGNSymlAqG5ieAu4CsReUZEngWKgD8GL6zwk5eRzNfFpXh9Bvp9H2KStXpIKdUhNLex+CXgTOB14DVglDHm5WAGFm6G9+lMebXHaidwRUH2FFj3NtRUhDo0pZRqlRMmAhEZWjcB3YFie+phr4sY3+vfBZdDeH/tHmvF4Iuh9gh8+15oA1NKqVZynWT7/55gmyFC+hsCSIp1c2bfVN5fu5s5kwZC77MgsTusehVypoU6PKWUarETJgJjTIfvYfRUnJudzq3z17BpXzmndUmwEsDSv0HFQYjrHOrwlFKqRZr7HMGPGpnOEZGuwQ4wnJybnQ7gVz00HXy1sG5+CKNSSqnWOZUuJp4E/sOengBuBD4VkQ4/ZGWdHsmx5PTsVJ8IuudDaj+rekgppdqp5iYCFzDIGDPNGDMNyMZqIxiJlRAixrmDurF8+yH2lVWDiNVovHUxlO4MdWhKKdUizU0EmcaYPX7Le+11B4GIerz2vDPSMQYWrrMvR850wMCa10Mal1JKtVRzE0GhiLwtIleKyJXAfHtdPFASvPDCz8BuiWSkxNZXD6X1gx5DtHpIKdVuNTcR/Ap4Gsi3p2eBXxljjkTanUUiwrnZ6XyycT9Hqj3WypzpsGsF7N8Q2uCUUqoFmvtksQEWAx8CC4GP7XUnJCITReQbEdkoInMa2X69iKwVka9FZKGI9D7VHyAUzs1Op8bj45MN+6wVOT8CREsFSql2qbm3j14CfAFMBy4BlorI9JMc4wQeBiZhNS5fJiLZx+z2FTDMGJMLvAr8+dTCD40RWZ1JinXz77rqoU49IGsMrHpFxzNWSrU7za0auglrdLIrjTEzgRHA709yzAhgozFmszGmBpgHTPHfwRizyB7xDGAJ1uA3Yc/ldHDOwK58uH4vHq89UlneZXBwM2z8ILTBKaXUKZJm1PAgIquMMYP9lh3ASv91jRwzHZhojLnaXr4CGGmMmd3E/g8Bu40xdzay7VrgWoD09PSCefPmnTTmxpSXl5OQkNCiY4+1bLeHh1dUM2dEDAM7OxFfLSOX/pKaqCSWD73XurU0hPEFg8bXOuEeH4R/jBpfy02YMKHIGDOs0Y3GmJNOwL3AAmCWPb0H3HOSY6YDT/otXwE81MS+P8YqEUSfLJaCggLTUosWLWrxsccqr6o1p9/0rrl9/pr6lV8+bcytnYz59t8tOmcg4wsGja91wj0+Y8I/Ro2v5YAvTROfq81tLL4BeBzItafHjTEne5BsJ5Dpt5xhr2tARL6PVfV0oTGmujnxhIP4aBdj+qXx/rrddckM8i6HpF5QeJe2FSil2o1mj1BmjHnNGHO9Pb3RjEOWAaeLSB8RiQJmYD1/cJSIDAH+hpUE9p5K4OHg3Ox0dhys5Js9ZdYKVxSM+3+ws0jbCpRS7cbJxiMoE5HDjUxlInL4RMcaYzzAbKwqpXXAK8aYNSJyh4hcaO92L5AA/ENEVohIu+q97ZxBXRGB99f4PXStpQKlVDtzsm6oE1tzcmPMu8C7x6y7xW/++605f6h1TYwhPzOZf6/dw3+ec7q1sq5U8NZ1Vqng9HNDG6RSSp3EqQxerxpxXnY3Vu0sZVdpZf1KLRUopdoRTQStVDdGwQdr/aqHtK1AKdWOaCJopX5dE+ibFl//lHGdvMshWUsFSqnwp4kgAM7NTmfJ5gMcrvLrkdsVBWN/a5UKNrwfuuCUUuokNBEEwHlnpFPrNRR+s6/hhrzLtFSglAp7mggCID8zhbSEqPoxCurUlQq+W66lAqVU2NJEEABOh3DOwHQK1++lqtbbcKOWCpRSYU4TQYBMye9BWbWH+Su/a7hBSwVKqTCniSBARp2WysBuiTz1yZb6vofqaKlAKRXGNBEEiIhw9di+fLOnjMUb9zfc6IqC791olQq+nBuaAJVSqgmaCALogrzudEmM5slPthy/Me9y6DsB/n0zHNjU9sEppVQTNBEEULTLycwze/PRt/vYUNcjaR2HA6Y8DA43vPkL8HkbP4lSSrUxTQQB9h9n9iba5WDup42UCpJ6wg/ugx1L4bMH2z44pZRqhCaCAOscH8W0ggxeW76TA+WNjLMz+GIYdCF8+EfYvbrtA1RKqWNoIgiCn47uQ43Hx/NLth+/UQR++BeITYE3fgaedjMom1Kqg9JEEAT9uiYwYUAXnluy9fgHzADi0+DCB2HPaii8u+0DVEopP5oIguTqsX3ZX15z/ANmdQZMgiFXwKcPwPalbRucUkr50UQQJGed6AGzOuf/CTplWFVENUfaNkCllLJpIggSEeGqMX0af8CsTkwnmPooHNoK79/S+D5KKRVkmgiC6ML8HqQlNPGAWZ2sMTDqV7DsSVIOLm+74JRSyqaJIIiiXU6uHNXEA2b+zv49dBnIwPX/B4ebaFNQSqkg0UQQZCd8wKyOOwZ+9ARObyX8fQqU72t6X6WUCjBNBEHWOT6KHw09wQNmdbrnsmrw76FkBzw/FSoPtV2QSqmIpomgDVw1JqvpB8z8lCafATOeh73r4YWLofoE1UlKKRUgmgjaQL+uiUcfMKuo8Zxk5+/DxU/DzuXw0mVQW9k2QSqlIpYmgjbyqwn92F9ew18Xbjj5zoMugKmPwdbF8MpM8NQEP0ClVMTSRNBGhmV15tJhmTz5yRbW7Tp88gNyL7H6JNrwb3j9GvCepCShlFItpImgDf1u8kCSY9387vVV+HzNGLJy2E+sp4/Xvgnz/xN8vuAHqZSKOJoI2lByXBQ3/3AQK3aU8MIXJ244PmrUr2D8/8DKF+G9GzQZKKUCThNBG7sovyej+6Xy53+tZ+/hquYd9L3/hrN+DcuehFdnQU1FUGNUSkUWTQRtTET4w5Qcqj0+7nh7bXMPgnPvgPPuhLXz4elJ+gSyUipgNBGEQN8uCcye0I+3v97Fom/2Nu8gETjrP+GyeXBgIzw+AXYWBTdQpVRE0EQQIj/7Xl9O6xLP799cTWXNKQxkP2AiXPU+uKLg6cmw+vXgBamUigiaCEIk2uXkT1MHU3yokgc/bMazBf7Ss+HqD6F7Prz6E1h0FzQ15oFSSp1EUBOBiEwUkW9EZKOIzGlk+zgRWS4iHhGZHsxYwtHIvqlcXJDBEx9vZv3uZjxb4C+hC1w5H/Iuh4/uthKCPoWslGqBoCUCEXECDwOTgGzgMhHJPma37cAs4MVgxRHu/mfyIDrFuvmf11fhO9Vv9a5ouOgRqyF5zZswdyLsXh2cQJVSHVYwSwQjgI3GmM3GmBpgHjDFfwdjzFZjzNdAxN4cnxIfxU2TB7F8ewkf7WjB08MiMPo6mPEilGyHv42Fd34LFQcDH6xSqkOSJsfTbe2JraqeicaYq+3lK4CRxpjZjez7DPC2MebVJs51LXAtQHp6esG8efNaFFN5eTkJCQktOjaYjDH8eVkVW0u93D46jq5xLcvPrtpysra+SM+d7+FxxbO57xXs6v59EGdA4gzX61dH42u9cI9R42u5CRMmFBljhjW60RgTlAmYDjzpt3wF8FAT+z4DTG/OeQsKCkxLLVq0qMXHBtu2/UdM9s1vm3P+t9CUVta07mS7Vhkzd5Ixt3Yy5rGxxmxbEpAYw/n6GaPxBUK4x6jxtRzwpWniczWYVUM7gUy/5Qx7nWpEr9Q4ZufHsHX/EWa/+BUebytqy7rlwKx3YNpT1mhnc8+D138GZbsDF7BSqsMIZiJYBpwuIn1EJAqYAcwP4vu1e4NSndx5UQ4ff7uPO99Z17qTicDg6TB7GYy5Hta8Dg8OhQU3weFdgQlYKdUhBC0RGGM8wGxgAbAOeMUYs0ZE7hCRCwFEZLiIFAMXA38TkTXBiqe9mDGiF1eP6cMzn23luSXbWn/C6AT4/q3wyyUwcDIseQT+mgvzfw0HNrX+/Eqpds8VzJMbY94F3j1m3S1+88uwqoyUn99NHsTm/Ue4bf4a+qTGM+b0tNafNPU0mPYkTLgJPnsQvnoBvnoOsi+CMb+B7rmtfw+lVLukTxaHIadD+OuMfPp1STOgJYMAABPESURBVOCXLxSxaV954E7euY814M1/rbJ6NN3wvnXL6fPTYMvHOgCOUhFIE0GYSoxx8+SVw3A7HVz97JeUVAR4uMrEdDj3dvjNajj79/DdV/DsBXBPFrxwCXz2f/DdCvCdQj9ISql2KahVQ6p1MjvH8bcrCrj8iaX84vnl/P2qEbidAc7dsckw7rdw5i/h2/dgyyew9RPYsMDaHpMMvUdDn3HEl0eDdww49c9GqY5E/6PD3LCsztwzfTC/eXklt/xzNX+aOhgRCfwbRcVBzjRrAmu8g62LYctHVnL45h2GA3x1o9XpXbfB0C0XuudB12yrUVop1S5pImgHpg7JYOPech5etOnowDZORxCSgb9OPSD3EmsCKNnO2gVzyU6uhd2rYN1bsPzv9s4Cqf2g60Bwx1tdZDujwRlVP++KsrZ17mPtm9xbSxZKhQn9T2wnfnveAIyBRwo3UVJRw18uzSfaFZiuI5oluRd708eTPX68tWwMHN4Ju762EsPur2Hft+CpAm8NeKrrX321x5/P4YKUPpB2unVHU2o/SO5lnddbYx9bUz/vrbHaK9wxVkKJigO3PUXFgTueqOoDVg+s7ti2uy5KdQCaCNoJEeG/Jw6kc3wUd76zjpKKZTw+cxgJ0SH6FYpAUoY1DZx84n3rPtyry+DgZti/AQ5ssEZa278RNi4Eb3WrQzoL4HPAFWO1bcSmWG0gsSnWclxnqySS0htSsqzEo0lDKU0E7c3VY/uSEhfFf7/2NZc9voRnfjKc1IToUId1YiJWl9muaIhPg8wRDbf7vFC6A0qLrZKC031M1ZI9icMqcdRWQs0RqK2wXyuhtoJvVxXRv1c6VB6ypqoSqCyxemWt/Boq9lvH+0vsbieHLEjOtBJD3fv5x+F0WwkmNgXiUiE+FaKTwNHKxntjrFJTXUkKsX5OEWs6umxPziitUlMBp39R7dC0ggxS4t388oXlXPzY5/z9qhFkpMSFOqyWczitD+KUrFad5ruDXek/dnzTOxgD5XuhZBsc2mpP9vzWxVZVF6fQG684rVJGXKo1xSSB8YG31q7K8jSYH1FWCl85rQ/9ox/+LSgJiaO+3cUZbSUo/7YYV4ydRGP8lu1tDpedVJxWonE4Gyz33bIJKv/VsIqvbt5bC1HxEJUA0YnHTJ2sbU63dS6HfU6Hs/7V4bISaUJXa99QM8b6HdVVY/o81rWoi9V/CsYNGsfG4qkG461fxtS/1q1zx1pfqAJME0E7dfbAdJ6/aiQ/fWYZ0x79jOeuGkn/9MRQhxXeRKznJxLTjy+VgF2FVWt9ONd9gPu3VXgqrZJGxUGoOHDMdBBKdljvUVeCcLjqSxgOF+XmEHE9etmlo5jjX51R9XEYH9YHga9+2XituDzVVoyemsbbZDxV1lRVcsw+VdZ5fL768xmfVSIz1roMccFe+8OmQbKJtn6e8r1WFV9NGVQdrv/gOlXuOKt0GN8F4rta83Gp1gfx0biOj7H/d9/B4ddp8OF4dJ76EqOnEmqrjn/1HtPu1Oy/HYf18+OXEI4mBzm6PMYn8EWMX4nSr3TpcPv9jirrf1e1p/CF4Af3w/Crmh93M2kiaMeGZXXmlZ+PYuZTX3DxY58zd9ZwCnqnhDqs9kvE/gYdFZTTry0spGtdY3uY+riwkPHNjdEY64Osuqx+8nmtD+/jXn3WTQMVB+HIvobT4WLYtcJKqMbUfyuvK6k46qvGUms9UBaFVWV2/AexlVRj7ZsK4iAuzZqvW9egqi+64Ye1w/449HmOmbz1pbv6H77+Ghxd5WP39m1kdO9q/az+Xya89rIzqj7xu2P8vgjEWn93dSW1up/raPWgvS5z5Kn+SptFE0E7N7BbJ177xVlc8dRSLn9iCXMmDeTKUVk4gn17qVIiVonHHWtV97SBz08lUYXAxsJCMsI4vqZoFxMdQGbnOF79xVmcdVoqt7+1lhlPLGH7gYpQh6WUaic0EXQQaQnRzJ01nD9Pz2Xdd4c5/4GP+fvnW/H5gjMUqVKq49BE0IGICJcMy2TBb8YxvE9nbvnnGv7jyaXsOKilA6VU0zQRdEA9kmN59ifDuftHg1m1s5SJD3zMC0u31Y0PrZRSDWgi6KBEhBkjerHgN+MY0iuFm95YzY+fWsrXxSWhDk0pFWY0EXRwPZNjee6qEdx5UQ6riku58KFPuXLuFxRtOxjq0JRSYUITQQQQEX58Zm8+nXM2N5w/gFU7S5n26Odc/sQSlmw+EOrwlFIhpokggiTGuPnVhH4svnECN00exLd7ypnx+BIueexzPv52n7YhKBWhNBFEoLgoF9eM68viGydw+4VnsONQBTPnfsFFj3zGa0XFVNXq8JRKRRJNBBEsxu3kyrOyKLxhPH+aOpiyylr+3z9WMuKPH3Db/DVs2FMW6hCVUm1Au5hQRLucXD6yF5eNyGTJ5oO8+MV2Xli6jWc+28rwrBQuG9GLyYO7hzpMpVSQaCJQR4kIo05LZdRpqRwoz+a15cW89MUOrn9lJbe/tZYRXQ3ujP0My0pp29HRlFJBpYlANSo1IZprx53GNWP78vmmA7z4xXb+tWoX7z+5lLgoJ2edlsb3BnRhfP8uZHZux2MhKKU0EagTExHO6pfGWf3S+NcHi3D1yKbw270UfrOPD9btAaBvl3jG9+/KuP5pDO2dQqcYd4ijVkqdCk0EqtliXML47HS+n52OMYbN+4/w0Tf7KPx2H88v3cbcT7cA0K9rAkMyk8nvlcyQzBT6pyfgcup9CUqFK00EqkVEhNO6JHBalwR+OqYPlTVeirYdYsWOQ3y1vYSF6/fyj6JiAGLdTnIzksjPTGZg90T6pydyWpcEYtzazqBUONBEoAIiNsrJmNPTGHN6GgDGGHYcrOQrOzF8taOEuZ9uodZrPbTmdAhZqXEM6GYlhgHpiZyenkhm51htiFaqjWkiUEEhIvRKjaNXahxT8nsCUOv1sXX/Eb7ZU8a3u8v4Zk8Z63aV8d7q3UdH/BOB7p1iyOwcR6+6KdV6zewcR2p8FBLsgcSVijCaCFSbcTsdnG5/8ye3fn1ljZdN+8rZsLeMbQcq2H6wgu0HKvjo233sLWs4qHe0y0H3pBi6J8XSPTmGHn6vxWU+9pdXkxIXhVOH6lSq2TQRqJCLjXKS0zOJnJ5Jx22rrPGy45CVGLYfrGBXaSXflVaxu7SKJZsOsKesGq/fKGy///QDHAKd46NJS4iiS2I0XRKiSUu0lpPjokiJiyIlzk1ynJvkuCiSY93amK0imiYCFdZio5z0T7faERrj8frYV17NdyVVLPy8iPRe/dhXVs3+cmvaV17D5n1H2F9eTbXH1+T7JMa4SI5zkxjtJiHGRWK0i4QYFwn2a2K0NR8X5SImykmc20lclNOaj3IS53YRE+Ug1u0kxu3ErYlFtSOaCFS75nI6rGqipFjKtrgYf1ZWo/sZYyiv9lBSUcuhihoOVdRSUlFzdLnEXi6v9lBW5WH34SrK93kor/JQVu2h5gRJpNG4HEKs20m020msnSBqKyt5ZP3nRLsdRLucRLsdxBzz6nY6iHIKbqc173Yds+x0EOUSXI76ebfTgcvhN+904HYKbod1vMthrdfqMtWUoCYCEZkI/BVwAk8aY+4+Zns08HegADgAXGqM2RrMmFRkEhESY9wkxrhb9CR0tcfLkWovlbVeKms8VNR4qaipW7bnazxU1fqoqrXWV9X6qKz1Um0v79xTidMhHKn2cKC8hiqPl+paH9X2a5XHe/SuqmBwiJU43Q45mixcDgcuZ10yEaoqK0letRinQ3A5BKdfEnE5BIffq1MaX+d0CA4RnA6ObnNK/XaHQxDBmhd73j6m/hzY5/A/n7Buj4fatXsavJ/DAS6H4+gxdfuK1J/DIfXbHPYx9cvW34f/PggNlkWsGxmEhvt3lBsXgpYIRMQJPAycCxQDy0RkvjFmrd9uVwGHjDH9RGQGcA9wabBiUqqlol3OVt/WWlhYyPjxZ55wH2MMtV5DrddHrddHjddnLXt89rqG2zwNlg0eb8P9PF7TcD+fNe/x+qj1Wa8erzk6v3tvJSmJ0XjqtvkMlbXeo8ten8FnDB6fweerf/Uag9dXP/kM1rzf+oD56svAnStAjiYFY3C8/y4ignB88pCjyQU7wdSt80tCgMNRf1x9YhKuO+d0LsjrEfD4g1kiGAFsNMZsBhCRecAUwD8RTAFus+dfBR4SETE6QoqKUCJClEuIcoWmjcFKVsODcm6fnUR8Bvu1PmGYuoRhDD4f9qv/Out16RfLGDp0mJ1gfHh9NExO9r4Nzlv3nj6DweD1We9vGsRib/dbBzSI1xgrURsDPgMGaxvGYOx9t23bTmavXvX7cvwx5pifv26711d/HureE+rjMZAUG5zuW4KZCHoCO/yWi4GRTe1jjPGISCmQCuwPYlxKqRBwOAQHratK2d3JyeCM4+8uCxeFhbsZP35gqMM4ZRKsL98iMh2YaIy52l6+AhhpjJntt89qe59ie3mTvc/+Y851LXAtQHp6esG8efNaFFN5eTkJCQktOrYtaHyto/G1XrjHqPG13IQJE4qMMcMa3WjsIlKgJ2AUsMBv+XfA747ZZwEwyp53YZUE5ETnLSgoMC21aNGiFh/bFjS+1tH4Wi/cY9T4Wg740jTxuRrMishlwOki0kdEooAZwPxj9pkPXGnPTwc+tANWSinVRoLWRmCsOv/ZWN/6ncBcY8waEbkDKzPNB54CnhORjcBBrGShlFKqDQX1OQJjzLvAu8esu8Vvvgq4OJgxKKWUOjF9Dl4ppSKcJgKllIpwmgiUUirCBe05gmARkX3AthYenkZ4P6ym8bWOxtd64R6jxtdyvY0xXRrb0O4SQWuIyJemqQcqwoDG1zoaX+uFe4waX3Bo1ZBSSkU4TQRKKRXhIi0RPB7qAE5C42sdja/1wj1GjS8IIqqNQCml1PEirUSglFLqGJoIlFIqwkVMIhCRiSLyjYhsFJE5oY7nWCKyVURWicgKEQn5WHwiMldE9tpjRtSt6ywi74vIBvs1Jcziu01EdtrXcIWITA5hfJkiskhE1orIGhG5zl4fFtfwBPGFxTUUkRgR+UJEVtrx3W6v7yMiS+3/45ftno3DKb5nRGSL3/XLD0V8pyoi2gjs8ZO/xW/8ZOAy03D85JASka3AMHPMoDyhIiLjgHLg78aYHHvdn4GDxpi77WSaYoy5MYziuw0oN8bcF4qY/IlId6C7MWa5iCQCRcBFwCzC4BqeIL5LCINrKNao8PHGmHIRcQOLgeuA64HXjTHzROQxYKUx5tEwiu/nwNvGmFfbOqbWiJQSwdHxk40xNUDd+MmqCcaYj7G6Bvc3BXjWnn8W64MjJJqIL2wYY3YZY5bb82XAOqyhWcPiGp4gvrBgj6VSbi+67ckAZ2ONbw6hvX5NxdcuRUoiaGz85LD5o7cZ4N8iUmQPzRmO0o0xu+z53UB6KINpwmwR+dquOgpZ1ZU/EckChgBLCcNreEx8ECbXUEScIrIC2Au8D2wCSowxHnuXkP4fHxufMabu+v3Rvn5/EZHoUMV3KiIlEbQHY4wxQ4FJwK/sqo+wZY8kF27fgB4FTgPygV3A/4Y2HBCRBOA14L+MMYf9t4XDNWwkvrC5hsYYrzEmH8jAKtWH1ajwx8YnIjlYQ/IOBIYDnYGQVJ2eqkhJBDuBTL/lDHtd2DDG7LRf9wJvYP3hh5s9dt1yXR3z3hDH04AxZo/9z+kDniDE19CuO34NeMEY87q9OmyuYWPxhds1tGMqARZhjYOeLCJ1A2qFxf+xX3wT7So3Y4ypBp4mDK5fc0RKImjO+MkhIyLxdoMdIhIPnAesPvFRIeE/xvSVwD9DGMtx6j5gbVMJ4TW0GxOfAtYZY+732xQW17Cp+MLlGopIFxFJtudjsW70WIf1gTvd3i2U16+x+Nb7JXnBar8Ix//j40TEXUMA9m1wD1A/fvIfQxzSUSLSF6sUANbwoS+GOj4ReQkYj9Wt7h7gVuBN4BWgF1ZX4JcYY0LSYNtEfOOxqjQMsBX4mV99fFvHNwb4BFgF+OzV/4NVDx/ya3iC+C4jDK6hiORiNQY7sb6wvmKMucP+X5mHVe3yFfBj+9t3uMT3IdAFEGAF8HO/RuWwFTGJQCmlVOMipWpIKaVUEzQRKKVUhNNEoJRSEU4TgVJKRThNBEopFeE0ESjVxsTqaTYt1HEoVUcTgVKNEIv+f6iIoH/oStlEJEusMSv+jvVE6FMislqscSIutfcZLyJv+x3zkIjMsue3isjtIrLcPmagvT5VRP5t91v/JNbDRnVPlL9j92m/uu49lGprmgiUauh04BHgFqy+bPKA7wP3HtP9QlP2250HPgr81l53K7DYGHMG1hPkvez1E4HvjDF59pgK/wrcj6FU82kiUKqhbcaYJcAY4CW7A7Y9wEdYPUqeTF3nckVAlj0/DngewBjzDnDIXr8KOFdE7hGRscaY0gD9DEqdEk0ESjV05CTbPTT8v4k5ZntdvzderH6jmmSM+RYYipUQ7hSRW04hTqUCRhOBUo37BLjUHnykC9a3+i+wOorLFpFou/fJc5pxro+BywFEZBKQYs/3ACqMMc8D92IlBaXa3Am/sSgVwd7A6v9+JVZPnP9tjNkNICKvYDUmb8HqAfNkbgdeEpE1wGfAdnv9YKy2Bx9QC/wioD+BUs2kvY8qpVSE06ohpZSKcJoIlFIqwmkiUEqpCKeJQCmlIpwmAqWUinCaCJRSKsJpIlBKqQj3/wHiYNUW8hVHJgAAAABJRU5ErkJggg==\n"},"metadata":{"needs_background":"light"}}],"source":["import pandas as pd\n","import numpy as np\n","import xgboost as xgb\n","import logging\n","from tqdm.notebook import tqdm\n","from gensim.models import Word2Vec\n","from scipy import spatial\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.model_selection import train_test_split\n","from sklearn.model_selection import StratifiedKFold\n","from sklearn.model_selection import cross_validate\n","from sklearn.metrics import classification_report\n","from sklearn.metrics import accuracy_score\n","from matplotlib import pyplot as plt\n","datasets = pd.read_csv(\"./drive/MyDrive/evmbytecodes.csv\", names=(\"label\", \"evmcode\")) #データセット読み込み\n","\n","# word2vec parameters\n","num_features    = 40\n","min_word_count  = 5\n","num_workers     = 40\n","context         = 10\n","downsampling    = 1e-3\n","model_name = \"evmcode_feature200.model\"\n","\n","# コーパス読み込み\n","corpus = []\n","tfidf_X = []\n","\n","# TF_IDFによる文書ベクトルの生成\n","vectorizer = TfidfVectorizer(max_features= num_features )\n","tfidf_X = vectorizer.fit_transform(datasets[\"evmcode\"])\n","print(tfidf_X.shape)\n","tfidf_data_X = pd.DataFrame(tfidf_X.toarray(),columns=[\"tfidf_X\"+str(i) for i in range(tfidf_X.shape[1])])\n","for doc in tqdm(datasets[\"evmcode\"]):\n","    corpus.append(doc.split(\" \"))\n","\n","# word2vecモデルの作成＆モデルの保存\n","print(\"creating word2vec model ...\")\n","logging.basicConfig(format='%(asctime)s : %(levelname)s : %(message)s', level=logging.INFO)\n","model = Word2Vec(corpus,size= num_features ,alpha=0.025,window=5,min_count=5,workers=4,min_alpha=0.001)\n","model.train(corpus,total_examples=len(corpus),epochs=50)\n","model.save(model_name)\n","print(\"Done.\")\n","\n","# word2vecによる文書ベクトルの生成\n","def wordvec2docvec(sentence,model):\n","    # 文章ベクトルの初期値（0ベクトルを初期値とする）\n","    docvecs = np.zeros(num_features, dtype=\"float32\")\n","    # 文章に現れる単語のうち、モデルに存在しない単語をカウントする\n","    denomenator = len(sentence)\n","    # 文章内の各単語ベクトルを足し合わせる\n","    for word in sentence:\n","        try:\n","            temp = model.wv[word]\n","        except:\n","            denomenator -= 1\n","            continue\n","        docvecs += temp\n","    # 文章に現れる単語のうち、モデルに存在した単語の数で割る\n","    if denomenator > 0:\n","        docvecs =  docvecs / denomenator\n","    return docvecs\n","\n","print(len(datasets[\"evmcode\"]))\n","X, Y = [], []\n","for lb, code in tqdm(zip(datasets[\"label\"], datasets[\"evmcode\"])):\n","    docvec = wordvec2docvec(code.split(\" \"),model)\n","    X.append(list(docvec))\n","    Y.append(lb)\n","\n","# データフレームの構築\n","data_X = pd.DataFrame(X, columns=[\"X\" + str(i + 1) for i in range(num_features)])\n","data_Y = pd.DataFrame(Y, columns=[\"label_id\"])\n","data_TFIDF_W2V = pd.concat([data_X,tfidf_data_X],axis=1)\n","print(data_TFIDF_W2V)\n","print(data_Y)\n","\n","# テストデータの分割\n","train_x, test_x, train_y, test_y = train_test_split(data_TFIDF_W2V, data_Y, train_size= 0.7)\n","\n","# XGBoost が扱うデータセットの形式に直す\n","dtrain = xgb.DMatrix(train_x, label=train_y)\n","dtest = xgb.DMatrix(test_x, label=test_y)\n","\n","# 学習用のパラメータ\n","xgb_params = {\n","    # 二値分類問題\n","    'objective': 'binary:logistic',\n","    # 評価指標\n","    'eval_metric': 'logloss',\n","    }\n","\n","# 学習時に用いる検証用データ\n","evals = [(dtrain, 'train'), (dtest, 'eval')]\n","# 学習過程を記録するための辞書\n","evals_result = {}\n","\n","# XGboostモデルの学習\n","print(\"Training XGboost model ...\")\n","#xgb_model = xgb.XGBClassifier()\n","#xgb_model.fit(train_x, train_y)\n","xgb_model = xgb.train(xgb_params,\n","                dtrain,\n","                num_boost_round = 1000, #多めに設定しておく\n","                early_stopping_rounds=10, #10ラウンド学習しても改善が見込めない場合は学習を打ち切る\n","                evals=evals,\n","                evals_result=evals_result)\n","print(\"Done.\")\n","\n","# 検証\n","pred_proba = xgb_model.predict(dtest)\n","pred = np.where(pred_proba > 0.5, 1, 0)\n","acc = accuracy_score(test_y, pred)\n","print('Accuracy:', acc)\n","#for p, i, l in zip(pred, test_y.index, test_y[\"label_id\"]) :\n","#  if p > 0.5 :\n","#    if l!=1:\n","#      ##予測ラベルが1でないなら対応するバイトコードを出力\n","#      datasets.loc[i].to_csv('./drive/MyDrive/ErrorList06.csv', mode='a')\n","#  else :\n","#    if l!=0:\n","#      ##予測ラベルが0でないなら対応するバイトコードを出力\n","#      datasets.loc[i].to_csv('./drive/MyDrive/ErrorList06.csv', mode='a')\n","\n","print(classification_report(pred, test_y[\"label_id\"]))\n","\n","# 学習の過程を折れ線グラフとして出力\n","train_metric = evals_result['train']['logloss']\n","plt.plot(train_metric, label='train logloss')\n","eval_metric = evals_result['eval']['logloss']\n","plt.plot(eval_metric, label='eval logloss')\n","plt.grid()\n","plt.legend()\n","plt.xlabel('rounds')\n","plt.ylabel('logloss')\n","plt.show()"]}]}