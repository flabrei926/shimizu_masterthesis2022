{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"mount_file_id":"18U3UjT_XWR_0hLnguC5r8nQOCd_9Meqs","authorship_tag":"ABX9TyOI8nynkrP5aroK9N7u2EUj"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"ce8a031554f3497e92d7c81142ae166c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_c70aeb83463b4ce5851a5e8162b4ed05","IPY_MODEL_ea120094041d454590aa0e3c9394c0e9","IPY_MODEL_61c483a2d974479ab562f858fd720571"],"layout":"IPY_MODEL_3d4df41f42594a4eaff11eb9cdf62f89"}},"c70aeb83463b4ce5851a5e8162b4ed05":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f708979aa6124ac8b25d02e774bb7f2b","placeholder":"​","style":"IPY_MODEL_af89e3cf33224476897e99b59f11c611","value":"100%"}},"ea120094041d454590aa0e3c9394c0e9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_64770de66a414a00864fa785fa432fe1","max":2313,"min":0,"orientation":"horizontal","style":"IPY_MODEL_57a2376773c84f588e6eec3960a11168","value":2313}},"61c483a2d974479ab562f858fd720571":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cfcea28678954d60b751031c0063dd24","placeholder":"​","style":"IPY_MODEL_993ca9e80aab4325944cd6673deaf1ca","value":" 2313/2313 [00:01&lt;00:00, 1519.05it/s]"}},"3d4df41f42594a4eaff11eb9cdf62f89":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f708979aa6124ac8b25d02e774bb7f2b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"af89e3cf33224476897e99b59f11c611":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"64770de66a414a00864fa785fa432fe1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"57a2376773c84f588e6eec3960a11168":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"cfcea28678954d60b751031c0063dd24":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"993ca9e80aab4325944cd6673deaf1ca":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"61a9efe0a85b40cdad7ebd5797d0ad5c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_361d0ee1615847cbbd0de375d5752337","IPY_MODEL_6b5a7cfd3bee420f8501e7e3609e96c2","IPY_MODEL_d1bf4cc958d74edca62d6aac6a77ebd2"],"layout":"IPY_MODEL_9582f83bbade4f1686c5f16cb751b61e"}},"361d0ee1615847cbbd0de375d5752337":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0fa3fa08bf3e4abe83750ab11f9e7258","placeholder":"​","style":"IPY_MODEL_765df1440ec94aec94001cfd335a79d2","value":""}},"6b5a7cfd3bee420f8501e7e3609e96c2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2ef60fc2d53341e29cc20355a0bd7d07","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_dd76fc98f107460bbdfe5334af718569","value":1}},"d1bf4cc958d74edca62d6aac6a77ebd2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1ac7a5aead95454b85b8e59a57e177ad","placeholder":"​","style":"IPY_MODEL_e45ebe1f5fe14e2bafc1ef973a216f56","value":" 2313/? [00:27&lt;00:00, 71.45it/s]"}},"9582f83bbade4f1686c5f16cb751b61e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0fa3fa08bf3e4abe83750ab11f9e7258":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"765df1440ec94aec94001cfd335a79d2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2ef60fc2d53341e29cc20355a0bd7d07":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"dd76fc98f107460bbdfe5334af718569":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1ac7a5aead95454b85b8e59a57e177ad":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e45ebe1f5fe14e2bafc1ef973a216f56":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["ce8a031554f3497e92d7c81142ae166c","c70aeb83463b4ce5851a5e8162b4ed05","ea120094041d454590aa0e3c9394c0e9","61c483a2d974479ab562f858fd720571","3d4df41f42594a4eaff11eb9cdf62f89","f708979aa6124ac8b25d02e774bb7f2b","af89e3cf33224476897e99b59f11c611","64770de66a414a00864fa785fa432fe1","57a2376773c84f588e6eec3960a11168","cfcea28678954d60b751031c0063dd24","993ca9e80aab4325944cd6673deaf1ca","61a9efe0a85b40cdad7ebd5797d0ad5c","361d0ee1615847cbbd0de375d5752337","6b5a7cfd3bee420f8501e7e3609e96c2","d1bf4cc958d74edca62d6aac6a77ebd2","9582f83bbade4f1686c5f16cb751b61e","0fa3fa08bf3e4abe83750ab11f9e7258","765df1440ec94aec94001cfd335a79d2","2ef60fc2d53341e29cc20355a0bd7d07","dd76fc98f107460bbdfe5334af718569","1ac7a5aead95454b85b8e59a57e177ad","e45ebe1f5fe14e2bafc1ef973a216f56"]},"id":"P1mnkrGPh_OI","executionInfo":{"status":"ok","timestamp":1675667638568,"user_tz":-540,"elapsed":379767,"user":{"displayName":"清水嶺","userId":"11678528705416048401"}},"outputId":"c87fc39e-111c-4055-991c-285ec64d613a"},"outputs":[{"output_type":"stream","name":"stdout","text":["(2313, 160)\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/2313 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ce8a031554f3497e92d7c81142ae166c"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["creating word2vec model ...\n"]},{"output_type":"stream","name":"stderr","text":["WARNING:gensim.models.base_any2vec:Effective 'alpha' higher than previous training cycles\n"]},{"output_type":"stream","name":"stdout","text":["Done.\n","2313\n"]},{"output_type":"display_data","data":{"text/plain":["0it [00:00, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"61a9efe0a85b40cdad7ebd5797d0ad5c"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["            X1        X2        X3        X4        X5        X6        X7  \\\n","0    -0.618738 -0.353011 -1.216526 -0.329010 -0.056994 -0.168119  0.633340   \n","1    -0.616435 -0.763210 -1.249774 -0.507572 -0.389409  0.006530  0.721067   \n","2    -0.641714 -0.682221 -1.278161 -0.476925 -0.353780 -0.004755  0.773954   \n","3    -0.644859 -0.682437 -1.275344 -0.475170 -0.345698 -0.010225  0.771015   \n","4    -0.628296 -0.601504 -1.168118 -0.407359 -0.325793 -0.023843  0.711232   \n","...        ...       ...       ...       ...       ...       ...       ...   \n","2308 -0.580495 -0.462201 -1.217739 -0.357478 -0.121367 -0.090096  0.733316   \n","2309 -0.562105 -0.323979 -1.144161 -0.249525 -0.099422 -0.109761  0.577721   \n","2310 -0.613426 -0.569185 -1.151751 -0.452827 -0.260014 -0.024915  0.731329   \n","2311 -0.596648 -0.365606 -1.223520 -0.279308 -0.037393 -0.112675  0.654550   \n","2312 -0.624279 -0.680306 -0.982507 -0.541449 -0.197977  0.000348  0.640893   \n","\n","            X8        X9       X10  ...  tfidf_X150  tfidf_X151  tfidf_X152  \\\n","0     0.015811 -0.060069  0.936736  ...    0.082029    0.022684    0.000251   \n","1     0.087942 -0.124896  0.935168  ...    0.056071    0.019409    0.009435   \n","2     0.124579 -0.264284  0.912904  ...    0.056192    0.019156    0.009777   \n","3     0.121892 -0.275217  0.911355  ...    0.056625    0.019304    0.009853   \n","4     0.096549 -0.373326  0.900595  ...    0.074415    0.023678    0.014798   \n","...        ...       ...       ...  ...         ...         ...         ...   \n","2308  0.075149 -0.023544  0.703880  ...    0.039438    0.012270    0.001438   \n","2309 -0.069731 -0.073985  0.881923  ...    0.069630    0.021192    0.002207   \n","2310  0.091607 -0.389288  0.886678  ...    0.044522    0.011716    0.012814   \n","2311 -0.012864 -0.023568  0.737144  ...    0.040610    0.015041    0.004935   \n","2312  0.097181 -0.243061  0.686465  ...    0.059260    0.024807    0.037683   \n","\n","      tfidf_X153  tfidf_X154  tfidf_X155  tfidf_X156  tfidf_X157  tfidf_X158  \\\n","0       0.106546    0.238068    0.092151    0.035775    0.018624    0.018060   \n","1       0.058227    0.284666    0.103560    0.030218    0.008656    0.000000   \n","2       0.081734    0.295009    0.127765    0.060075    0.005126    0.000000   \n","3       0.081077    0.295996    0.124887    0.060538    0.005166    0.000000   \n","4       0.068778    0.286385    0.107159    0.044011    0.002263    0.000000   \n","...          ...         ...         ...         ...         ...         ...   \n","2308    0.105606    0.238381    0.106967    0.027630    0.014950    0.017671   \n","2309    0.092839    0.294664    0.099946    0.048480    0.030379    0.053642   \n","2310    0.063269    0.297597    0.129523    0.025798    0.006466    0.001074   \n","2311    0.135366    0.251180    0.099312    0.036129    0.024148    0.030327   \n","2312    0.024807    0.121277    0.001379    0.000000    0.000000    0.000000   \n","\n","      tfidf_X159  \n","0       0.011094  \n","1       0.000000  \n","2       0.002378  \n","3       0.002397  \n","4       0.000000  \n","...          ...  \n","2308    0.008160  \n","2309    0.018792  \n","2310    0.000000  \n","2311    0.005602  \n","2312    0.000000  \n","\n","[2313 rows x 320 columns]\n","      label_id\n","0            0\n","1            0\n","2            0\n","3            0\n","4            0\n","...        ...\n","2308         1\n","2309         1\n","2310         1\n","2311         1\n","2312         1\n","\n","[2313 rows x 1 columns]\n","Training XGboost model ...\n","[0]\ttrain-logloss:0.450073\teval-logloss:0.463778\n","Multiple eval metrics have been passed: 'eval-logloss' will be used for early stopping.\n","\n","Will train until eval-logloss hasn't improved in 10 rounds.\n","[1]\ttrain-logloss:0.315058\teval-logloss:0.337095\n","[2]\ttrain-logloss:0.228225\teval-logloss:0.255416\n","[3]\ttrain-logloss:0.169076\teval-logloss:0.199354\n","[4]\ttrain-logloss:0.126098\teval-logloss:0.158862\n","[5]\ttrain-logloss:0.095628\teval-logloss:0.131151\n","[6]\ttrain-logloss:0.073456\teval-logloss:0.111015\n","[7]\ttrain-logloss:0.056926\teval-logloss:0.097035\n","[8]\ttrain-logloss:0.045227\teval-logloss:0.086901\n","[9]\ttrain-logloss:0.036126\teval-logloss:0.079258\n","[10]\ttrain-logloss:0.029585\teval-logloss:0.073397\n","[11]\ttrain-logloss:0.024283\teval-logloss:0.070526\n","[12]\ttrain-logloss:0.020218\teval-logloss:0.067269\n","[13]\ttrain-logloss:0.017339\teval-logloss:0.066086\n","[14]\ttrain-logloss:0.014929\teval-logloss:0.064615\n","[15]\ttrain-logloss:0.013004\teval-logloss:0.064073\n","[16]\ttrain-logloss:0.011567\teval-logloss:0.06372\n","[17]\ttrain-logloss:0.010239\teval-logloss:0.061191\n","[18]\ttrain-logloss:0.009248\teval-logloss:0.06165\n","[19]\ttrain-logloss:0.008482\teval-logloss:0.060744\n","[20]\ttrain-logloss:0.00776\teval-logloss:0.060751\n","[21]\ttrain-logloss:0.007298\teval-logloss:0.059683\n","[22]\ttrain-logloss:0.006824\teval-logloss:0.059387\n","[23]\ttrain-logloss:0.006438\teval-logloss:0.060398\n","[24]\ttrain-logloss:0.006088\teval-logloss:0.059318\n","[25]\ttrain-logloss:0.005734\teval-logloss:0.058544\n","[26]\ttrain-logloss:0.005462\teval-logloss:0.058988\n","[27]\ttrain-logloss:0.005223\teval-logloss:0.05899\n","[28]\ttrain-logloss:0.005063\teval-logloss:0.058731\n","[29]\ttrain-logloss:0.004935\teval-logloss:0.059345\n","[30]\ttrain-logloss:0.004747\teval-logloss:0.05949\n","[31]\ttrain-logloss:0.004574\teval-logloss:0.05938\n","[32]\ttrain-logloss:0.004435\teval-logloss:0.058718\n","[33]\ttrain-logloss:0.00435\teval-logloss:0.059249\n","[34]\ttrain-logloss:0.004259\teval-logloss:0.058825\n","[35]\ttrain-logloss:0.004142\teval-logloss:0.058833\n","Stopping. Best iteration:\n","[25]\ttrain-logloss:0.005734\teval-logloss:0.058544\n","\n","Done.\n","Accuracy: 0.9740634005763689\n","              precision    recall  f1-score   support\n","\n","           0       0.85      0.82      0.84        56\n","           1       0.98      0.99      0.99       638\n","\n","    accuracy                           0.97       694\n","   macro avg       0.92      0.90      0.91       694\n","weighted avg       0.97      0.97      0.97       694\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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3OEopVREiLlEsNF0thb2bwhvMEopFSFiKxGkONh49BZSbSdQSimIsUSQnSTsJpM6R7y2EyilTik/P58DB05+ALW+c7rmmDZtGrNnzz7T0FpUTCWCOKeQ0yaZve5usD+6BqRWSqlgialEANA9K8WqHtIrAqVarb/97W8MHz6cgoICvve97+H1ennmmWe4/fbbj27z0ksvMX36dKDxbqkD8eijj5Kfn09+fj6PPfbY0fL777+f3r17c9555zF16tQGB7CZN28egwcPZsCAAdx4443U1NQAVh9D/fr1Y+DAgdx2220A/P3vfyc/P59BgwYxevTo0z4nTYmZ5wjq9chKZkVxNufXzofqUkhIC3dISrVe/7gD9q4CINHrAWcLfOV0GAATH2p09bp163jjjTdYuHAhbrebH/zgB7z66qtMmTKFc845h4cffhiAN954gzvvvBMIrFvqhixdupQZM2awaNEijDGcffbZjBkzBo/Hw5tvvsmKFSuoq6tjyJAhFBYWHrdvdXU106ZNY968efTq1Yvrr7+ep59+muuuu463336b9evXIyJHR0y77777mDt3Lp06dTqtUdQCEZNXBGs8doPxAb1zSKnWZt68eSxdupRhw4ZRUFDAvHnz2LJlC1lZWXTv3p3PP/+cgwcPsn79ekaOHAkE1i11Qz799FMuv/xykpOTSUlJ4Vvf+haffPIJCxcuZPLkySQkJJCamsqll1560r5fffUVeXl59OrVCzjWdXV6ejoJCQl897vf5a233iIpKQmAkSNHMm3aNJ577jm8Xm8LnS1LTF4RPO9/51DnoeENSKnWzO+Xe1WIuqE2xnDDDTfw4IMPnrTu6quvZtasWfTp04fLL78cEQm4W+pQcblcLF68mHnz5jF79myeeOIJPv74Y5555hkWLVrEhx9+SGFhIUuXLg3oqiUQMXdF0CMrhR2mPV5HnN5CqlQrdMEFFzB79mz27dsHWMNAbtu2DYDLL7+cd999l9dff52rr74aOLNuqUeNGsU777xDZWUlFRUVvP3224waNYqRI0fy/vvvU11dTXl5OR988MFJ+/bu3Zvi4mI2bdoEHOu6ury8nJKSEi666CL+9Kc/sWLFCgA2b97M2WefzX333UdWVhY7duw4o/PkL+auCNqnxpMUH8e++K501AZjpVqdfv368cADDzB+/Hh8Ph9ut5snn3yS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\n"},"metadata":{"needs_background":"light"}}],"source":["import pandas as pd\n","import numpy as np\n","import xgboost as xgb\n","import logging\n","from tqdm.notebook import tqdm\n","from gensim.models import Word2Vec\n","from scipy import spatial\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.model_selection import train_test_split\n","from sklearn.model_selection import StratifiedKFold\n","from sklearn.model_selection import cross_validate\n","from sklearn.metrics import classification_report\n","from sklearn.metrics import accuracy_score\n","from matplotlib import pyplot as plt\n","datasets = pd.read_csv(\"./drive/MyDrive/evmbytecodes.csv\", names=(\"label\", \"evmcode\")) #データセット読み込み\n","\n","# word2vec parameters\n","num_features    = 160\n","min_word_count  = 5\n","num_workers     = 40\n","context         = 10\n","downsampling    = 1e-3\n","model_name = \"evmcode_feature200.model\"\n","\n","# コーパス読み込み\n","corpus = []\n","tfidf_X = []\n","\n","# TF_IDFによる文書ベクトルの生成\n","vectorizer = TfidfVectorizer(max_features= num_features)\n","tfidf_X = vectorizer.fit_transform(datasets[\"evmcode\"])\n","print(tfidf_X.shape)\n","tfidf_data_X = pd.DataFrame(tfidf_X.toarray(),columns=[\"tfidf_X\"+str(i) for i in range(tfidf_X.shape[1])])\n","for doc in tqdm(datasets[\"evmcode\"]):\n","    corpus.append(doc.split(\" \"))\n","\n","# word2vecモデルの作成＆モデルの保存\n","print(\"creating word2vec model ...\")\n","logging.basicConfig(format='%(asctime)s : %(levelname)s : %(message)s', level=logging.INFO)\n","model = Word2Vec(corpus,size= num_features,alpha=0.025,window=5,min_count=5,workers=4,min_alpha=0.001)\n","model.train(corpus,total_examples=len(corpus),epochs=50)\n","model.save(model_name)\n","print(\"Done.\")\n","\n","# word2vecによる文書ベクトルの生成\n","def wordvec2docvec(sentence,model):\n","    # 文章ベクトルの初期値（0ベクトルを初期値とする）\n","    docvecs = np.zeros(num_features, dtype=\"float32\")\n","    # 文章に現れる単語のうち、モデルに存在しない単語をカウントする\n","    denomenator = len(sentence)\n","    # 文章内の各単語ベクトルを足し合わせる\n","    for word in sentence:\n","        try:\n","            temp = model.wv[word]\n","        except:\n","            denomenator -= 1\n","            continue\n","        docvecs += temp\n","    # 文章に現れる単語のうち、モデルに存在した単語の数で割る\n","    if denomenator > 0:\n","        docvecs =  docvecs / denomenator\n","    return docvecs\n","\n","print(len(datasets[\"evmcode\"]))\n","X, Y = [], []\n","for lb, code in tqdm(zip(datasets[\"label\"], datasets[\"evmcode\"])):\n","    docvec = wordvec2docvec(code.split(\" \"),model)\n","    X.append(list(docvec))\n","    Y.append(lb)\n","\n","# データフレームの構築\n","data_X = pd.DataFrame(X, columns=[\"X\" + str(i + 1) for i in range(num_features)])\n","data_Y = pd.DataFrame(Y, columns=[\"label_id\"])\n","data_TFIDF_W2V = pd.concat([data_X,tfidf_data_X],axis=1)\n","print(data_TFIDF_W2V)\n","print(data_Y)\n","\n","# テストデータの分割\n","train_x, test_x, train_y, test_y = train_test_split(data_TFIDF_W2V, data_Y, train_size= 0.7)\n","\n","# XGBoost が扱うデータセットの形式に直す\n","dtrain = xgb.DMatrix(train_x, label=train_y)\n","dtest = xgb.DMatrix(test_x, label=test_y)\n","\n","# 学習用のパラメータ\n","xgb_params = {\n","    # 二値分類問題\n","    'objective': 'binary:logistic',\n","    # 評価指標\n","    'eval_metric': 'logloss',\n","    }\n","\n","# 学習時に用いる検証用データ\n","evals = [(dtrain, 'train'), (dtest, 'eval')]\n","# 学習過程を記録するための辞書\n","evals_result = {}\n","\n","# XGboostモデルの学習\n","print(\"Training XGboost model ...\")\n","#xgb_model = xgb.XGBClassifier()\n","#xgb_model.fit(train_x, train_y)\n","xgb_model = xgb.train(xgb_params,\n","                dtrain,\n","                num_boost_round = 1000, #多めに設定しておく\n","                early_stopping_rounds=10, #10ラウンド学習しても改善が見込めない場合は学習を打ち切る\n","                evals=evals,\n","                evals_result=evals_result)\n","print(\"Done.\")\n","\n","# 検証\n","pred_proba = xgb_model.predict(dtest)\n","pred = np.where(pred_proba > 0.5, 1, 0)\n","acc = accuracy_score(test_y, pred)\n","print('Accuracy:', acc)\n","#for p, i, l in zip(pred, test_y.index, test_y[\"label_id\"]) :\n","#  if p > 0.5 :\n","#    if l!=1:\n","#      ##予測ラベルが1でないなら対応するバイトコードを出力\n","#      datasets.loc[i].to_csv('./drive/MyDrive/ErrorList06.csv', mode='a')\n","#  else :\n","#    if l!=0:\n","#      ##予測ラベルが0でないなら対応するバイトコードを出力\n","#      datasets.loc[i].to_csv('./drive/MyDrive/ErrorList06.csv', mode='a')\n","\n","print(classification_report(pred, test_y[\"label_id\"]))\n","\n","# 学習の過程を折れ線グラフとして出力\n","train_metric = evals_result['train']['logloss']\n","plt.plot(train_metric, label='train logloss')\n","eval_metric = evals_result['eval']['logloss']\n","plt.plot(eval_metric, label='eval logloss')\n","plt.grid()\n","plt.legend()\n","plt.xlabel('rounds')\n","plt.ylabel('logloss')\n","plt.show()"]}]}