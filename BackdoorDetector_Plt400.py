{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"mount_file_id":"1PN1j_gnCWKPgeyebhwFeDtghWflUjlZC","authorship_tag":"ABX9TyPikJeenvJSIKE1Si/OCO/w"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"2c16121d38cf48f28785f8942ec9d227":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8865d6def0eb403fb085ba76c8390a2e","IPY_MODEL_75e291e5361c4930986432bcb6dfb587","IPY_MODEL_76093629cf054078984a4ab8a8e1350d"],"layout":"IPY_MODEL_9f8112b68e55488bb2e405972d1155a3"}},"8865d6def0eb403fb085ba76c8390a2e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5cdce3ca7d2a47fe9f0f86da7e5533b3","placeholder":"​","style":"IPY_MODEL_f015029c54dc482f9558d30c300c43be","value":"100%"}},"75e291e5361c4930986432bcb6dfb587":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4458862fdca8436eb5c0af9691fe5349","max":2313,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bb3511c15ec64359b8dbbd052e071fea","value":2313}},"76093629cf054078984a4ab8a8e1350d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ecff9c268afe4d1dba6f05e74632a9d0","placeholder":"​","style":"IPY_MODEL_cefa4358b3f14817ba1ee6b15a3979ee","value":" 2313/2313 [00:01&lt;00:00, 2254.50it/s]"}},"9f8112b68e55488bb2e405972d1155a3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5cdce3ca7d2a47fe9f0f86da7e5533b3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f015029c54dc482f9558d30c300c43be":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4458862fdca8436eb5c0af9691fe5349":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bb3511c15ec64359b8dbbd052e071fea":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ecff9c268afe4d1dba6f05e74632a9d0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cefa4358b3f14817ba1ee6b15a3979ee":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bc0ed02405704a31828ec1b38ff68431":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1b368fb2a61b49e9a1386b419bc5a05a","IPY_MODEL_5684e1ff001146009c9c1f06ad90e851","IPY_MODEL_8f9b08270cfe4f94a7cb5a3d85bfbb11"],"layout":"IPY_MODEL_26b88ef717b446439da5166ad98aee4e"}},"1b368fb2a61b49e9a1386b419bc5a05a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_46552d5e4f5c4190aeb0859dd31712ca","placeholder":"​","style":"IPY_MODEL_be8855e23572425184000e2150f5ba91","value":""}},"5684e1ff001146009c9c1f06ad90e851":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7df8310f50d84e1e938385e724a94549","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4519b08e0f5743bab99dbeb655c650f0","value":1}},"8f9b08270cfe4f94a7cb5a3d85bfbb11":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3ddb7352c37e4ec68f86ddfc0f78e5a1","placeholder":"​","style":"IPY_MODEL_824da910bd6c4575bd0327217c21f646","value":" 2313/? [00:33&lt;00:00, 63.49it/s]"}},"26b88ef717b446439da5166ad98aee4e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"46552d5e4f5c4190aeb0859dd31712ca":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"be8855e23572425184000e2150f5ba91":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7df8310f50d84e1e938385e724a94549":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"4519b08e0f5743bab99dbeb655c650f0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3ddb7352c37e4ec68f86ddfc0f78e5a1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"824da910bd6c4575bd0327217c21f646":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["2c16121d38cf48f28785f8942ec9d227","8865d6def0eb403fb085ba76c8390a2e","75e291e5361c4930986432bcb6dfb587","76093629cf054078984a4ab8a8e1350d","9f8112b68e55488bb2e405972d1155a3","5cdce3ca7d2a47fe9f0f86da7e5533b3","f015029c54dc482f9558d30c300c43be","4458862fdca8436eb5c0af9691fe5349","bb3511c15ec64359b8dbbd052e071fea","ecff9c268afe4d1dba6f05e74632a9d0","cefa4358b3f14817ba1ee6b15a3979ee","bc0ed02405704a31828ec1b38ff68431","1b368fb2a61b49e9a1386b419bc5a05a","5684e1ff001146009c9c1f06ad90e851","8f9b08270cfe4f94a7cb5a3d85bfbb11","26b88ef717b446439da5166ad98aee4e","46552d5e4f5c4190aeb0859dd31712ca","be8855e23572425184000e2150f5ba91","7df8310f50d84e1e938385e724a94549","4519b08e0f5743bab99dbeb655c650f0","3ddb7352c37e4ec68f86ddfc0f78e5a1","824da910bd6c4575bd0327217c21f646"]},"id":"3JXhVUNorm7p","executionInfo":{"status":"ok","timestamp":1675670281571,"user_tz":-540,"elapsed":602218,"user":{"displayName":"清水嶺","userId":"11678528705416048401"}},"outputId":"c3f6e0d2-61af-4a8f-ea3b-862c20b403cd"},"outputs":[{"output_type":"stream","name":"stdout","text":["(2313, 400)\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/2313 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2c16121d38cf48f28785f8942ec9d227"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["creating word2vec model ...\n"]},{"output_type":"stream","name":"stderr","text":["WARNING:gensim.models.base_any2vec:Effective 'alpha' higher than previous training cycles\n"]},{"output_type":"stream","name":"stdout","text":["Done.\n","2313\n"]},{"output_type":"display_data","data":{"text/plain":["0it [00:00, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"bc0ed02405704a31828ec1b38ff68431"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["            X1        X2        X3        X4        X5        X6        X7  \\\n","0    -0.208937  0.007612  0.291166 -0.229489  0.285257 -0.048320  0.338476   \n","1    -0.274467 -0.050914  0.374760 -0.186686  0.341978  0.078788  0.182174   \n","2    -0.240794  0.040324  0.294905 -0.045091  0.268476  0.021146  0.227226   \n","3    -0.236165  0.033944  0.291353 -0.044992  0.269435  0.018776  0.230843   \n","4    -0.235807 -0.033374  0.268730 -0.024493  0.226612 -0.039983  0.256787   \n","...        ...       ...       ...       ...       ...       ...       ...   \n","2308 -0.251998  0.126859  0.224652 -0.026880  0.256769 -0.106835  0.336250   \n","2309 -0.180767 -0.013774  0.231574 -0.245450  0.292233 -0.044341  0.263993   \n","2310 -0.244923  0.001094  0.277558  0.006045  0.196344 -0.028392  0.272442   \n","2311 -0.258733  0.163495  0.238340 -0.079008  0.260285 -0.076572  0.293363   \n","2312 -0.240771  0.060778  0.259068  0.295897  0.105886 -0.187604  0.253488   \n","\n","            X8        X9       X10  ...  tfidf_X390  tfidf_X391  tfidf_X392  \\\n","0     0.470592 -0.413131 -0.197311  ...    0.106496    0.237955    0.092107   \n","1     0.537580 -0.471606 -0.348741  ...    0.058225    0.284653    0.103555   \n","2     0.421321 -0.385536 -0.374153  ...    0.081730    0.294996    0.127759   \n","3     0.420514 -0.387961 -0.374548  ...    0.081073    0.295983    0.124881   \n","4     0.357708 -0.367527 -0.424226  ...    0.068762    0.286322    0.107135   \n","...        ...       ...       ...  ...         ...         ...         ...   \n","2308  0.398116 -0.312852 -0.205981  ...    0.105580    0.238321    0.106940   \n","2309  0.456380 -0.380494 -0.219903  ...    0.092806    0.294560    0.099911   \n","2310  0.354361 -0.375691 -0.421982  ...    0.063268    0.297595    0.129522   \n","2311  0.440846 -0.320754 -0.149174  ...    0.135238    0.250941    0.099217   \n","2312  0.236099 -0.291357 -0.349945  ...    0.024662    0.120570    0.001371   \n","\n","      tfidf_X393  tfidf_X394  tfidf_X395  tfidf_X396  tfidf_X397  tfidf_X398  \\\n","0       0.035758    0.018615    0.018051    0.011089    0.009057    0.003508   \n","1       0.030217    0.008656    0.000000    0.000000    0.000000    0.000000   \n","2       0.060073    0.005126    0.000000    0.002378    0.000000    0.000000   \n","3       0.060536    0.005165    0.000000    0.002396    0.000000    0.000000   \n","4       0.044001    0.002262    0.000000    0.000000    0.000000    0.000000   \n","...          ...         ...         ...         ...         ...         ...   \n","2308    0.027624    0.014947    0.017666    0.008158    0.008663    0.009394   \n","2309    0.048463    0.030368    0.053623    0.018786    0.016623    0.012360   \n","2310    0.025798    0.006466    0.001074    0.000000    0.000000    0.000000   \n","2311    0.036095    0.024126    0.030298    0.005597    0.000000    0.000000   \n","2312    0.000000    0.000000    0.000000    0.000000    0.000000    0.000000   \n","\n","      tfidf_X399  \n","0       0.004954  \n","1       0.005831  \n","2       0.000000  \n","3       0.000000  \n","4       0.000000  \n","...          ...  \n","2308    0.011846  \n","2309    0.000000  \n","2310    0.000000  \n","2311    0.000000  \n","2312    0.022230  \n","\n","[2313 rows x 800 columns]\n","      label_id\n","0            0\n","1            0\n","2            0\n","3            0\n","4            0\n","...        ...\n","2308         1\n","2309         1\n","2310         1\n","2311         1\n","2312         1\n","\n","[2313 rows x 1 columns]\n","Training XGboost model ...\n","[0]\ttrain-logloss:0.449573\teval-logloss:0.468766\n","Multiple eval metrics have been passed: 'eval-logloss' will be used for early stopping.\n","\n","Will train until eval-logloss hasn't improved in 10 rounds.\n","[1]\ttrain-logloss:0.313621\teval-logloss:0.345122\n","[2]\ttrain-logloss:0.226085\teval-logloss:0.265743\n","[3]\ttrain-logloss:0.167162\teval-logloss:0.210424\n","[4]\ttrain-logloss:0.125102\teval-logloss:0.169077\n","[5]\ttrain-logloss:0.094749\teval-logloss:0.142154\n","[6]\ttrain-logloss:0.073266\teval-logloss:0.123679\n","[7]\ttrain-logloss:0.056891\teval-logloss:0.110475\n","[8]\ttrain-logloss:0.044636\teval-logloss:0.097737\n","[9]\ttrain-logloss:0.035579\teval-logloss:0.08977\n","[10]\ttrain-logloss:0.028658\teval-logloss:0.082802\n","[11]\ttrain-logloss:0.023651\teval-logloss:0.078238\n","[12]\ttrain-logloss:0.019677\teval-logloss:0.075438\n","[13]\ttrain-logloss:0.016703\teval-logloss:0.07288\n","[14]\ttrain-logloss:0.014279\teval-logloss:0.070715\n","[15]\ttrain-logloss:0.012433\teval-logloss:0.069402\n","[16]\ttrain-logloss:0.010869\teval-logloss:0.067887\n","[17]\ttrain-logloss:0.009647\teval-logloss:0.065776\n","[18]\ttrain-logloss:0.008721\teval-logloss:0.06422\n","[19]\ttrain-logloss:0.007857\teval-logloss:0.063395\n","[20]\ttrain-logloss:0.007186\teval-logloss:0.06379\n","[21]\ttrain-logloss:0.00665\teval-logloss:0.062838\n","[22]\ttrain-logloss:0.00627\teval-logloss:0.063242\n","[23]\ttrain-logloss:0.005917\teval-logloss:0.063779\n","[24]\ttrain-logloss:0.005618\teval-logloss:0.063358\n","[25]\ttrain-logloss:0.005387\teval-logloss:0.062967\n","[26]\ttrain-logloss:0.005129\teval-logloss:0.062885\n","[27]\ttrain-logloss:0.004915\teval-logloss:0.063105\n","[28]\ttrain-logloss:0.004731\teval-logloss:0.063453\n","[29]\ttrain-logloss:0.004551\teval-logloss:0.063801\n","[30]\ttrain-logloss:0.004429\teval-logloss:0.064342\n","[31]\ttrain-logloss:0.004275\teval-logloss:0.064323\n","Stopping. Best iteration:\n","[21]\ttrain-logloss:0.00665\teval-logloss:0.062838\n","\n","Done.\n","Accuracy: 0.9726224783861671\n","              precision    recall  f1-score   support\n","\n","           0       0.77      0.91      0.83        53\n","           1       0.99      0.98      0.99       641\n","\n","    accuracy                           0.97       694\n","   macro avg       0.88      0.94      0.91       694\n","weighted avg       0.98      0.97      0.97       694\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAYIAAAEGCAYAAABo25JHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3deXxU5b348c93JpN9hYSwhLAZAiGEfRPZbFFc6op7UWqR6i23iz+t9tqrlvZebbXWa7VaraLWBVeUCi4tEAEVEJB9B1kiS9gC2bd5fn+cEzKEJAxJJjOZ+b5fr/Oas8/3mYH55pznOc8jxhiUUkqFLoe/A1BKKeVfmgiUUirEaSJQSqkQp4lAKaVCnCYCpZQKcWH+DuBcJScnm+7duzfp2OLiYmJiYlo2ID/RsgSeYCkHaFkCVXPKsmrVqiPGmJT6trW5RNC9e3dWrlzZpGNzc3MZP358ywbkJ1qWwBMs5QAtS6BqTllEZE9D2/TWkFJKhThNBEopFeI0ESilVIhrc3UESqnAVllZSV5eHmVlZf4OBYCEhAQ2b97s7zBahDdliYyMJC0tDZfL5fV5NREopVpUXl4ecXFxdO/eHRHxdzgUFhYSFxfn7zBaxNnKYozh6NGj5OXl0aNHD6/Pq7eGlFItqqysjPbt2wdEEgg1IkL79u3P+WpME4FSqsVpEvCfpnz2oZMI9i6jx65XQbvdVkqp04ROIjiwlm5734PCA/6ORCnlQwUFBfz1r39t0rGXXnopBQUFXu//8MMP8/jjjzfpvXJzc7n88subdGxLC51E0GmA9XpgnX/jUEr5VGOJoKqqqtFj58+fT2Jioi/CCmihkwhSszEIHNREoFQwu//++9m5cycDBw7k3nvvZcmSJYwZM4YrrriCrKwsAK666iqGDBlCv379eP75508d2717d44cOcLu3bvp27cvd9xxB/369eOiiy6itLS00fdds2YNI0eOJCcnh6uvvprjx48D8PXXX5OTk3Mqnuzs7DOOPXbsGFdddRU5OTmMHDmSdeus36nPP/+cgQMHMnDgQAYNGkRhYSEHDhxg7NixDBw4kOzsbJYsWdLszyx0mo9GxFIa1YnoA2v9HYlSIeO3/9zIpv0nW/ScWZ3jeegH/Rrc/uijj7JhwwbWrFkDWH/lr169mg0bNpxqUvnSSy/Rrl07SktLGTZsGNdeey3t27c/7Tzbt2/nzTff5IUXXuD666/nvffe44c//GGD73vrrbfyl7/8hXHjxvHggw/y29/+lieffJIf/ehHvPDCC4waNYr777+/3mMfeughBg0axAcffMDChQu59dZbWbNmDY8//jjPPPMMo0ePpqioiMrKSl566SUuvvhiHnjgAaqrqykpKTnXj/AMoXNFABTG9dJbQ0qFoOHDh5/Wrv6pp55iwIABjBw5kn379rF9+/YzjunRowcDBw4EYMiQIezevbvB8584cYKCggLGjRsHwG233cbixYspKCigsLCQUaNGAXDzzTfXe/zSpUuZMmUKABdeeCFHjx7l5MmTjB49mrvvvpunnnqKgoICwsLCGDZsGLNmzeLhhx9m/fr1LfKMROhcEQBFsT1JzV8CJccgup2/w1Eq6DX2l3tr8uy6OTc3l3//+9989dVXREdHM378+Hrb3UdERJyadzqdZ7015Av3338/l112GfPnz2f06NG8//77jB07lsWLFzNv3jymTp3K3Xffza233tqs9wmpK4Ki2J7WjNYTKBW04uLiKCwsbHD7iRMnSEpKIjo6mi1btrBs2bJmv2dCQgJJSUmn7tf/4x//YNy4cSQmJhIXF8fy5csBmD17dr3Hjxkzhtdffx2wElVycjLx8fHs3LmT/v37c9999zFs2DC2bdvGnj17SE1N5Y477mDatGmsXr262fGHzBXB7iPFLCxOZwBYt4d6jvdvQEopn2jfvj2jR48mOzubSy65hAkTJpy2fdKkSTz33HP07duXzMxMRo4c2SLv+8orr3DnnXdSUlJCz549mTVrFgAvvvgid9xxBw6Hg3HjxpGQkHDGsQ8//DC33347OTk5REdH88orrwDw5JNPsmjRIhwOB/369WPixInMmzePxx57DJfLRWxsLK+++mrzgzfGtKlpyJAhpimey91hut33kal+vK8x79zepHMEkkWLFvk7hBYTLGUJlnIY07yybNq0qeUCaQEnT5706/sXFhaemn/kkUfMz372syafy9uy1PcdACtNA7+rIXNFkNnRqlApSOhLO701pJRqJfPmzeORRx6hqqqKbt268fLLL/s7pDOETCLo0zEegL0RGbTLWwAVxRAeHOOYKqUC1w033MANN9zg7zAaFTKVxanxEcS4YF11N8DAwQ3+DkkppQJCyCQC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\n"},"metadata":{"needs_background":"light"}}],"source":["import pandas as pd\n","import numpy as np\n","import xgboost as xgb\n","import logging\n","from tqdm.notebook import tqdm\n","from gensim.models import Word2Vec\n","from scipy import spatial\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.model_selection import train_test_split\n","from sklearn.model_selection import StratifiedKFold\n","from sklearn.model_selection import cross_validate\n","from sklearn.metrics import classification_report\n","from sklearn.metrics import accuracy_score\n","from matplotlib import pyplot as plt\n","datasets = pd.read_csv(\"./drive/MyDrive/evmbytecodes.csv\", names=(\"label\", \"evmcode\")) #データセット読み込み\n","\n","# word2vec parameters\n","num_features    = 400\n","min_word_count  = 5\n","num_workers     = 40\n","context         = 10\n","downsampling    = 1e-3\n","model_name = \"evmcode_feature200.model\"\n","\n","# コーパス読み込み\n","corpus = []\n","tfidf_X = []\n","\n","# TF_IDFによる文書ベクトルの生成\n","vectorizer = TfidfVectorizer(max_features= num_features )\n","tfidf_X = vectorizer.fit_transform(datasets[\"evmcode\"])\n","print(tfidf_X.shape)\n","tfidf_data_X = pd.DataFrame(tfidf_X.toarray(),columns=[\"tfidf_X\"+str(i) for i in range(tfidf_X.shape[1])])\n","for doc in tqdm(datasets[\"evmcode\"]):\n","    corpus.append(doc.split(\" \"))\n","\n","# word2vecモデルの作成＆モデルの保存\n","print(\"creating word2vec model ...\")\n","logging.basicConfig(format='%(asctime)s : %(levelname)s : %(message)s', level=logging.INFO)\n","model = Word2Vec(corpus,size= num_features ,alpha=0.025,window=5,min_count=5,workers=4,min_alpha=0.001)\n","model.train(corpus,total_examples=len(corpus),epochs=50)\n","model.save(model_name)\n","print(\"Done.\")\n","\n","# word2vecによる文書ベクトルの生成\n","def wordvec2docvec(sentence,model):\n","    # 文章ベクトルの初期値（0ベクトルを初期値とする）\n","    docvecs = np.zeros(num_features, dtype=\"float32\")\n","    # 文章に現れる単語のうち、モデルに存在しない単語をカウントする\n","    denomenator = len(sentence)\n","    # 文章内の各単語ベクトルを足し合わせる\n","    for word in sentence:\n","        try:\n","            temp = model.wv[word]\n","        except:\n","            denomenator -= 1\n","            continue\n","        docvecs += temp\n","    # 文章に現れる単語のうち、モデルに存在した単語の数で割る\n","    if denomenator > 0:\n","        docvecs =  docvecs / denomenator\n","    return docvecs\n","\n","print(len(datasets[\"evmcode\"]))\n","X, Y = [], []\n","for lb, code in tqdm(zip(datasets[\"label\"], datasets[\"evmcode\"])):\n","    docvec = wordvec2docvec(code.split(\" \"),model)\n","    X.append(list(docvec))\n","    Y.append(lb)\n","\n","# データフレームの構築\n","data_X = pd.DataFrame(X, columns=[\"X\" + str(i + 1) for i in range(num_features)])\n","data_Y = pd.DataFrame(Y, columns=[\"label_id\"])\n","data_TFIDF_W2V = pd.concat([data_X,tfidf_data_X],axis=1)\n","print(data_TFIDF_W2V)\n","print(data_Y)\n","\n","# テストデータの分割\n","train_x, test_x, train_y, test_y = train_test_split(data_TFIDF_W2V, data_Y, train_size= 0.7)\n","\n","# XGBoost が扱うデータセットの形式に直す\n","dtrain = xgb.DMatrix(train_x, label=train_y)\n","dtest = xgb.DMatrix(test_x, label=test_y)\n","\n","# 学習用のパラメータ\n","xgb_params = {\n","    # 二値分類問題\n","    'objective': 'binary:logistic',\n","    # 評価指標\n","    'eval_metric': 'logloss',\n","    }\n","\n","# 学習時に用いる検証用データ\n","evals = [(dtrain, 'train'), (dtest, 'eval')]\n","# 学習過程を記録するための辞書\n","evals_result = {}\n","\n","# XGboostモデルの学習\n","print(\"Training XGboost model ...\")\n","#xgb_model = xgb.XGBClassifier()\n","#xgb_model.fit(train_x, train_y)\n","xgb_model = xgb.train(xgb_params,\n","                dtrain,\n","                num_boost_round = 1000, #多めに設定しておく\n","                early_stopping_rounds=10, #10ラウンド学習しても改善が見込めない場合は学習を打ち切る\n","                evals=evals,\n","                evals_result=evals_result)\n","print(\"Done.\")\n","\n","# 検証\n","pred_proba = xgb_model.predict(dtest)\n","pred = np.where(pred_proba > 0.5, 1, 0)\n","acc = accuracy_score(test_y, pred)\n","print('Accuracy:', acc)\n","#for p, i, l in zip(pred, test_y.index, test_y[\"label_id\"]) :\n","#  if p > 0.5 :\n","#    if l!=1:\n","#      ##予測ラベルが1でないなら対応するバイトコードを出力\n","#      datasets.loc[i].to_csv('./drive/MyDrive/ErrorList06.csv', mode='a')\n","#  else :\n","#    if l!=0:\n","#      ##予測ラベルが0でないなら対応するバイトコードを出力\n","#      datasets.loc[i].to_csv('./drive/MyDrive/ErrorList06.csv', mode='a')\n","\n","print(classification_report(pred, test_y[\"label_id\"]))\n","\n","# 学習の過程を折れ線グラフとして出力\n","train_metric = evals_result['train']['logloss']\n","plt.plot(train_metric, label='train logloss')\n","eval_metric = evals_result['eval']['logloss']\n","plt.plot(eval_metric, label='eval logloss')\n","plt.grid()\n","plt.legend()\n","plt.xlabel('rounds')\n","plt.ylabel('logloss')\n","plt.show()"]}]}